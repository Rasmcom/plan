<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุฌุงู ุงูุซูุงูุฉ ูุงููููู | ุฎุทุฉ 1447ูู</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        @font-face { font-family: 'Sakkal Majalla'; src: local('Sakkal Majalla'), url('https://fonts.cdnfonts.com/s/72921/Sakkal Majalla.woff') format('woff'); }
        @font-face { font-family: 'AL Mohanad'; src: local('AL Mohanad'), url('https://alfont.net/fonts/a-l-mohanad-340/AL-Mohanad-Light.woff') format('woff'); }

        body { font-family: 'Tajawal', sans-serif; background-color: #f7fafc; }
        
        .tab-button { transition: all 0.3s ease; border-bottom: 4px solid transparent; border-radius: 8px 8px 0 0; background-color: #e2e8f0; color: #4a5568; }
        .tab-button.active { border-color: #38a169; background-color: #ffffff; color: #2c7a7b; font-weight: 700; }
        .content-section { display: none; }
        .content-section.active { display: block; }
        
        /* ุชูุณูู ุตูุญุฉ A4 ุงูุฃุณุงุณู */
        .a4-page { width: 210mm; min-height: 297mm; padding: 12mm 5mm; margin: 1cm auto; border: 1px #D1D5DB solid; border-radius: 5px; background: white; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); display: flex; flex-direction: column; }
        .a4-page main { flex-grow: 1; }
        
        .report-label { color: #067693; background-color: #f0f9ff; font-weight: bold; padding: 8px; border-left: 4px solid #0891b2; }
        .table-bordered th, .table-bordered td { border: 1px solid #ddd; padding: 4px; text-align: right; vertical-align: top; font-size: 0.8rem; }
        .table-bordered th { background-color: #2c5aa0; color: white; }
        .gradient-line { height: 5px; background: linear-gradient(to left, #28a745, #007bff); border-radius: 2.5px; }
        
        /* Date Picker Styles */
        #date-picker-modal .week-grid .day.selected { background-color: #0d9488 !important; color: white !important; border-color: #0f766e; }
        #date-picker-modal .week-grid .day.selected span { color: white !important; }
        #date-picker-modal .week-grid .day.disabled { background-color: #F3F4F6; color: #9CA3AF; cursor: not-allowed; }
        .holiday-note { grid-column: span 5; text-align: center; padding: 8px; background-color: #fee2e2; color: #991b1b; border-radius: 4px; font-size: 0.9rem; }

        textarea { min-height: 40px; overflow: hidden; resize: none; }
        .print-only-content { display: none; }

        /* ==========================================================================
           ุชุญุณููุงุช ุงูุฌูุงู (ูุฃุฎูุฐุฉ ูู ููุฏ ุงูุฃูุงู ูุงูููุงุณุจุงุช)
           ========================================================================== */
        @media screen and (max-width: 768px) {
            .container { padding-left: 0; padding-right: 0; }
            /* ุชุญููู ูุฑูุฉ A4 ุฅูู ุชุตููู ูุฑู ูููุฃ ุงูุดุงุดุฉ */
            .a4-page { width: 100%; min-height: 0; padding: 16px; margin: 0; border: none; box-shadow: none; }
            .no-print, header.no-print { padding-left: 1rem; padding-right: 1rem; }
            h1 { font-size: 1.5rem; }
            .tab-button { font-size: 0.875rem; padding: 8px 12px; }
            /* ุฌุนู ุงูุฌุฏุงูู ูุงุจูุฉ ููุชูุฑูุฑ ุฃูููุงู */
            .table-bordered { display: block; overflow-x: auto; white-space: nowrap; }
            .table-bordered th, .table-bordered td { white-space: normal; min-width: 120px; } /* ุถูุงู ุนุฑุถ ููุงุณุจ ููุฎูุงูุง */
            
            /* ุชุนุฏูู ุงูุดุจูุงุช ูุชุตุจุญ ุนููุฏ ูุงุญุฏ ูู ุงููุนุงููุฉ */
            .a4-page .grid-cols-2 { grid-template-columns: repeat(1, minmax(0, 1fr)); }
            .flex-1 { min-width: 0; }
            /* ุฅุตูุงุญ ุงูุชุฐููู ูู ุงูุฌูุงู */
            #output-plan footer .grid-cols-2, #output-report footer .grid-cols-2 { grid-template-columns: repeat(1, minmax(0, 1fr)); gap: 1rem; }
            
            /* ุชุญุณูู ุนุฑุถ ุฑูุน ุงูุตูุฑ */
            #image-upload-grid { grid-template-columns: repeat(2, 1fr); }
        }

        @media print {
            .no-print, textarea, input[type="text"], button { display: none !important; }
            .print-only-content { display: block !important; white-space: pre-wrap; word-wrap: break-word; font-size: inherit; font-family: inherit; color: #000; padding: 2px; }
            .content-section { display: none !important; }
            .content-section.printable-active { display: block !important; }
            html, body { width: 100% !important; height: auto !important; background: white !important; font-size: 9pt; overflow: visible !important; margin: 0 !important; padding: 0 !important; }
            .a4-page { width: 100% !important; margin: 0 !important; padding: 0 !important; border: none !important; box-shadow: none !important; display: block !important; page-break-inside: avoid; }
            .a4-page main { display: block !important; flex-grow: 0 !important; }
            .table-bordered { width: 100%; border-collapse: collapse; display: table !important; overflow: visible !important; white-space: normal !important; }
            .table-bordered th, .table-bordered td { border: 1px solid #ccc !important; padding: 4px !important; }
            .table-bordered th { background-color: #2c5aa0 !important; color: white !important; -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
            .report-label { background-color: #f0f9ff !important; color: #000 !important; border-left: 1px solid #000 !important; -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
            #image-upload-grid { display: grid !important; grid-template-columns: repeat(3, 1fr) !important; gap: 4px !important; }
            .image-upload-slot { aspect-ratio: auto !important; height: 3.5cm !important; border: 1px solid #ccc !important; display: flex !important; align-items: center; justify-content: center; page-break-inside: avoid !important; }
            .image-upload-slot img { width: 100% !important; height: 100% !important; object-fit: contain !important; display: block !important; }
            .image-upload-slot:not(.has-image) { display: none !important; }
            .container { padding: 0 !important; margin: 0 !important; width: 100% !important; max-width: none !important; }
        }
    </style>
</head>
<body class="text-slate-800">

<div class="container mx-auto px-4 py-8">
    <header class="flex justify-between items-center mb-8 pb-4 border-b-2 border-teal-600 no-print">
        <div class="flex items-center gap-4">
            <img src="https://upload.wikimedia.org/wikipedia/ar/thumb/1/17/Saudi_Ministry_of_Education_Logo_2025.png/400px-Saudi_Ministry_of_Education_Logo_2025.png" alt="ุดุนุงุฑ ูุฒุงุฑุฉ ุงูุชุนููู" class="h-16 md:h-20"> <!-- ุชุตุบูุฑ ุงูุดุนุงุฑ ููููุงู ููุฌูุงู -->
            <div>
                <h1 class="text-2xl md:text-3xl font-bold text-teal-800">ูุฌุงู ุงูุซูุงูุฉ ูุงููููู</h1>
                <p class="text-slate-600 text-sm md:text-base">ุฅุฏุงุฑุฉ ุฎุทุท ูุชูุงุฑูุฑ ุจุฑุงูุฌ ุงููุฌุงู - 1447ูู</p>
            </div>
        </div>
    </header>

    <div class="flex justify-center gap-2 mb-8 no-print">
        <button id="tab-btn-plan" class="tab-button active flex items-center gap-2 text-base md:text-lg py-3 px-4 md:px-6">ุฎุทุฉ ุจุฑุงูุฌ ุงููุดุงุท</button>
        <button id="tab-btn-reports" class="tab-button flex items-center gap-2 text-base md:text-lg py-3 px-4 md:px-6">ุงูุชูุงุฑูุฑ</button>
    </div>

    <main>
        <!-- Plan Section -->
        <div id="content-plan" class="content-section active">
            <div id="setup-screen-plan" class="no-print">
                <div class="max-w-4xl mx-auto bg-white p-4 md:p-8 rounded-2xl shadow-lg border border-slate-200">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6"> <!-- ุชู ุชุนุฏูู Grid ููููู 1 ูู ุงูุฌูุงู -->
                        <input type="text" id="education-admin" placeholder="ุงูุฅุฏุงุฑุฉ ุงูุชุนููููุฉ: ..." class="w-full p-3 border border-slate-300 rounded-lg">
                        <input type="text" id="school-name" placeholder="ุงููุฏุฑุณุฉ: ..." class="w-full p-3 border border-slate-300 rounded-lg">
                    </div>
                    
                    <div class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <h3 class="text-xl font-bold mb-3 text-teal-700">1. ุงุฎุชุฑ ุงูููุทูุฉ</h3>
                                <div class="flex gap-3">
                                    <button id="btn-region-other" class="w-full p-3 border rounded-lg transition bg-teal-600 text-white">ุจุงูู ุงูููุงุทู</button>
                                    <button id="btn-region-western" class="w-full p-3 border rounded-lg transition">ุงูููุทูุฉ ุงูุบุฑุจูุฉ</button>
                                </div>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold mb-3 text-teal-700">2. ุงุฎุชุฑ ุงููุฑุญูุฉ</h3>
                                <select id="stage-select-plan" class="w-full p-3 border border-slate-300 rounded-lg"></select>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold mb-3 text-teal-700">3. ุงุฎุชุฑ ุงูุจุฑูุงูุฌ</h3>
                            <select id="program-select-plan" class="w-full p-3 border border-slate-300 rounded-lg" disabled></select>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold mb-3 text-teal-700">4. ุงุฎุชุฑ ุงููุฏู</h3>
                            <select id="objective-select" class="w-full p-3 border border-slate-300 rounded-lg bg-slate-50" disabled></select>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <h3 class="text-xl font-bold mb-3 text-teal-700">5. ุงูุชูุงุฑูุฎ</h3>
                                <button id="date-picker-btn" class="w-full p-3 border border-slate-300 rounded-lg text-right text-slate-500 hover:bg-slate-50 transition" disabled>ุงุฎุชุฑ ุชูุงุฑูุฎ ุงูุญุตุต</button>
                                <div id="program-details-plan" class="border-2 border-teal-100 bg-teal-50/50 p-3 rounded-lg mt-4 text-sm min-h-[60px]"></div>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold mb-3 text-teal-700">6. ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ</h3>
                                <div class="space-y-4">
                                    <input type="text" id="teacher-name" placeholder="ุงููุนูู/ุฉ ุงููููุฐ/ุฉ" class="w-full p-3 border border-slate-300 rounded-lg">
                                    <input type="text" id="leader-name" placeholder="ุฑุงุฆุฏ/ุฉ ุงููุดุงุท" class="w-full p-3 border border-slate-300 rounded-lg">
                                    <input type="text" id="director-name" placeholder="ูุฏูุฑ/ุฉ ุงููุฏุฑุณุฉ" class="w-full p-3 border border-slate-300 rounded-lg">
                                </div>
                            </div>
                        </div>
                         <div>
                            <h3 class="text-xl font-bold mb-3 text-teal-700">7. ุชูุงุตูู ุฅุถุงููุฉ</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <textarea id="additional-achievements" placeholder="ุงูุฅูุฌุงุฒุงุช" class="w-full p-3 border border-slate-300 rounded-lg h-24"></textarea>
                                <textarea id="strengths" placeholder="ููุงุท ุงูููุฉ" class="w-full p-3 border border-slate-300 rounded-lg h-24"></textarea>
                                <textarea id="difficulties" placeholder="ุงูุตุนูุจุงุช" class="w-full p-3 border border-slate-300 rounded-lg h-24"></textarea>
                                <textarea id="remedial-actions" placeholder="ุงูุฅุฌุฑุงุกุงุช ุงูุนูุงุฌูุฉ" class="w-full p-3 border border-slate-300 rounded-lg h-24"></textarea>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold mb-3 text-teal-700">8. ุงุฎุชูุงุฑ ุงูุฎุท</h3>
                            <select id="font-select" class="w-full p-3 border border-slate-300 rounded-lg">
                                <option value="Tajawal">ุงูุฎุท ุงูุงูุชุฑุงุถู (Tajawal)</option>
                                <option value="Sakkal Majalla">Sakkal Majalla</option>
                                <option value="AL Mohanad">AL Mohanad</option>
                            </select>
                        </div>
                    </div>
                    <div class="mt-10 text-center flex flex-col md:flex-row gap-4 justify-center">
                        <button id="generate-plan-btn" class="w-full md:w-auto bg-teal-600 text-white font-bold py-3 px-10 rounded-lg hover:bg-teal-700 transition text-lg">ุฅุนุฏุงุฏ ุงูุฎุทุฉ ููุทุจุงุนุฉ</button>
                        <button id="reset-plan-btn" class="w-full md:w-auto bg-red-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-red-700 transition">ุฅุนุงุฏุฉ ุชุนููู</button>
                    </div>
                </div>
            </div>

            <!-- Output Plan A4 -->
            <div id="output-plan" class="hidden">
                 <div class="text-center mb-6 no-print flex flex-col md:flex-row justify-center gap-3">
                    <button onclick="printContent('output-plan')" class="w-full md:w-auto bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700 transition">๐จ๏ธ ุทุจุงุนุฉ ุงูุฎุทุฉ</button>
                    <button onclick="document.getElementById('output-plan').classList.add('hidden'); document.getElementById('setup-screen-plan').classList.remove('hidden');" class="w-full md:w-auto bg-slate-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-slate-700 transition">๐ ุงูุนูุฏุฉ</button>
                </div>
                <div class="a4-page">
                    <header class="mb-4">
                        <div class="flex justify-between items-center pb-2">
                            <img src="https://upload.wikimedia.org/wikipedia/ar/thumb/1/17/Saudi_Ministry_of_Education_Logo_2025.png/400px-Saudi_Ministry_of_Education_Logo_2025.png" alt="ุดุนุงุฑ ูุฒุงุฑุฉ ุงูุชุนููู" class="h-16 md:h-20">
                            <div class="flex-1 mr-4 space-y-2 text-base text-right">
                                <p id="report-education-admin-plan" class="font-bold"></p>
                                <p id="report-school-name-plan" class="font-bold"></p>
                            </div>
                        </div>
                        <div class="gradient-line mt-2"></div>
                        <h2 class="text-xl md:text-2xl font-bold text-teal-800 text-center mt-4">ุฎุทุฉ ุชูููุฐ ุจุฑูุงูุฌ ุงููุดุงุท ุงูุทูุงุจู</h2>
                    </header>
                    <main>
                        <table class="w-full mb-4 text-sm border-collapse table-fixed table-bordered">
                            <tbody>
                                <tr>
                                    <td class="report-label w-[15%]">ุงุณู ุงูุจุฑูุงูุฌ:</td>
                                    <td class="p-0 border border-slate-200 w-[35%]"><textarea id="report-program-name-plan" class="w-full border-none p-2 resize-none bg-transparent" rows="1"></textarea></td>
                                    <td class="report-label w-[15%]">ุชูุงุตูู ุงูุจุฑูุงูุฌ:</td>
                                    <td class="p-0 border border-slate-200 w-[35%]"><textarea id="report-program-details-name-plan" class="w-full border-none p-2 resize-none bg-transparent" rows="1"></textarea></td>
                                </tr>
                                <tr>
                                    <td class="report-label">ุงููุฏู ูู ุงูุจุฑูุงูุฌ:</td>
                                    <td class="p-0 border border-slate-200"><textarea id="report-objective-plan" class="w-full border-none p-2 resize-none bg-transparent" rows="1"></textarea></td>
                                    <td class="report-label">ุงููุฆุฉ ุงููุณุชูุฏูุฉ:</td>
                                    <td class="p-0 border border-slate-200"><textarea id="report-program-target-plan" class="w-full border-none p-2 resize-none bg-transparent" rows="1"></textarea></td>
                                </tr>
                                <tr>
                                    <td class="report-label">ุงููุนูู/ุฉ ุงููููุฐ/ุฉ:</td>
                                    <td class="p-0 border border-slate-200"><textarea id="report-teacher-name-plan" class="w-full border-none p-2 resize-none bg-transparent" rows="1"></textarea></td>
                                    <td class="report-label">ูุฏุฉ ุงูุชูููุฐ:</td>
                                    <td class="p-0 border border-slate-200"><textarea id="report-duration-plan" class="w-full border-none p-2 resize-none bg-transparent" rows="1"></textarea></td>
                                </tr>
                                <tr>
                                    <td class="report-label">ููุงู ุงูุชูููุฐ:</td>
                                    <td class="p-0 border border-slate-200 whitespace-pre-line"><textarea id="report-location-plan" class="w-full border-none p-2 resize-none bg-transparent" rows="1"></textarea></td>
                                    <td class="report-label">ุฃุฏูุงุช ุงูุชูููุฐ:</td>
                                    <td class="p-0 border border-slate-200 whitespace-pre-line"><textarea id="report-tools-plan" class="w-full border-none p-2 resize-none bg-transparent" rows="1"></textarea></td>
                                </tr>
                                <tr>
                                    <td class="report-label align-top">ููุงุชุฌ ุงูุชุนูู:</td>
                                    <td class="p-0 border border-slate-200 whitespace-pre-line" colspan="3"><textarea id="report-learning-outcomes-plan" class="w-full border-none p-2 resize-none bg-transparent" rows="3"></textarea></td>
                                </tr>
                                <tr>
                                    <td class="report-label w-1/4 align-top">ุฃุณุงููุจ ุงูุชูููู:</td>
                                    <td class="p-0 border border-slate-200 whitespace-pre-line" colspan="3"><textarea id="report-assessment-methods-plan" class="w-full border-none p-2 resize-none bg-transparent" rows="2"></textarea></td>
                                </tr>
                            </tbody>
                        </table>
                        <table class="w-full table-bordered mb-6">
                            <thead class="bg-teal-50 font-bold">
                                <tr><th class="w-[8%]">ุงูุฃุณุจูุน</th><th class="w-[13%]">ุงูุชุงุฑูุฎ</th><th class="w-[14%]">ุนููุงู ุงูุญุตุฉ</th><th class="w-[52%]">ุงููุญุชูู ูุงูุฅุฌุฑุงุกุงุช</th><th class="w-[13%]">ุงูุญุงูุฉ</th></tr>
                            </thead>
                            <tbody id="plan-table-body"></tbody>
                        </table>
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div><h4 class="report-label mb-1">ุงูุฅูุฌุงุฒุงุช</h4><div class="p-0 border border-slate-200 min-h-[40px] whitespace-pre-wrap"><textarea id="report-additional-achievements-plan" class="w-full border-none p-2 resize-none bg-transparent" rows="3"></textarea></div></div>
                            <div><h4 class="report-label mb-1">ููุงุท ุงูููุฉ</h4><div class="p-0 border border-slate-200 min-h-[40px] whitespace-pre-wrap"><textarea id="report-strengths-plan" class="w-full border-none p-2 resize-none bg-transparent" rows="3"></textarea></div></div>
                            <div><h4 class="report-label mb-1">ุงูุตุนูุจุงุช</h4><div class="p-0 border border-slate-200 min-h-[40px] whitespace-pre-wrap"><textarea id="report-difficulties-plan" class="w-full border-none p-2 resize-none bg-transparent" rows="3"></textarea></div></div>
                            <div><h4 class="report-label mb-1">ุงูุฅุฌุฑุงุกุงุช ุงูุนูุงุฌูุฉ</h4><div class="p-0 border border-slate-200 min-h-[40px] whitespace-pre-wrap"><textarea id="report-remedial-actions-plan" class="w-full border-none p-2 resize-none bg-transparent" rows="3"></textarea></div></div>
                        </div>
                    </main>
                    <footer class="pt-8 text-center text-xs">
                        <div class="gradient-line mb-4"></div>
                        <div class="grid grid-cols-2 gap-16">
                            <div class="pt-2 mt-2"><p id="report-leader-name-plan" class="font-bold h-6"></p></div>
                            <div class="pt-2 mt-2"><p id="report-director-name-plan" class="font-bold h-6"></p></div>
                        </div>
                    </footer>
                </div>
            </div>
        </div>

        <!-- Reports Section -->
        <div id="content-reports" class="content-section">
            <div id="setup-screen-reports" class="no-print">
                <div class="max-w-4xl mx-auto bg-white p-4 md:p-8 rounded-2xl shadow-lg border border-slate-200">
                    <h2 class="text-xl md:text-2xl font-bold text-teal-800 mb-6">ุฅุนุฏุงุฏ ุชูุฑูุฑ ุจุฑูุงูุฌ ุงููุดุงุท</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <select id="stage-select-reports" class="w-full p-3 border border-slate-300 rounded-lg"></select>
                        <select id="program-select-reports" class="w-full p-3 border border-slate-300 rounded-lg" disabled></select>
                    </div>
                    <div id="report-dates-display" class="mt-4 text-center text-slate-600 bg-slate-100 p-3 rounded-lg text-sm">ุงุฎุชุฑ ูุฑุญูุฉ ูุจุฑูุงูุฌ ูุนุฑุถ ุงูุชูุงุฑูุฎ</div>
                     <div class="mt-6 text-center">
                        <button id="generate-report-btn" class="w-full md:w-auto bg-teal-600 text-white font-bold py-3 px-10 rounded-lg hover:bg-teal-700 transition text-lg" disabled>ุฅูุดุงุก ูููุฐุฌ ุงูุชูุฑูุฑ</button>
                    </div>
                </div>
            </div>
            <div id="output-report" class="hidden">
                 <div class="text-center mb-6 no-print flex flex-col md:flex-row justify-center gap-3">
                    <button onclick="printContent('output-report')" class="w-full md:w-auto bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700 transition">๐จ๏ธ ุทุจุงุนุฉ ุงูุชูุฑูุฑ</button>
                    <button onclick="document.getElementById('output-report').classList.add('hidden'); document.getElementById('setup-screen-reports').classList.remove('hidden');" class="w-full md:w-auto bg-slate-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-slate-700 transition">๐ ุงูุนูุฏุฉ</button>
                </div>
                <div class="a4-page" id="report-page-content"></div>
            </div>
        </div>
    </main>
</div>

<!-- Date Picker Modal -->
<div id="date-picker-modal" class="fixed inset-0 z-50 items-center justify-center p-4 bg-black bg-opacity-50 hidden no-print backdrop-blur-sm">
    <div class="bg-white rounded-lg shadow-xl p-4 md:p-6 max-w-4xl w-full max-h-[90vh] flex flex-col">
        <h3 id="modal-title" class="text-lg md:text-xl font-bold mb-4">ุงุฎุชุฑ ุชูุงุฑูุฎ ุงูุชูููุฐ</h3>
        <div id="modal-weeks-container" class="flex-grow overflow-y-auto space-y-4"></div>
        <div class="mt-6 flex flex-col md:flex-row justify-end gap-3 pt-4 border-t">
            <button onclick="closeDatePicker()" class="w-full md:w-auto px-4 py-2 bg-gray-300 text-gray-800 rounded-lg hover:bg-gray-400">ุฅูุบุงุก</button>
            <button onclick="saveDates()" class="w-full md:w-auto px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700">ุญูุธ ุงูุชูุงุฑูุฎ</button>
        </div>
    </div>
</div>

<footer class="text-center py-6 mt-12 border-t border-slate-200 no-print">
    <a href="https://www.rasmcom.com" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center gap-3 text-sm text-gray-600 hover:text-teal-700 transition" style="text-decoration: none;">
        <img src="https://e.top4top.io/p_3463x5tj40.png" alt="ุดุนุงุฑ ุฑุณู" class="h-8 md:h-10 w-auto">
        <span>ุฌููุน ุงูุญููู ูุญููุธุฉ ูููุงุฉ ุฑุณู ููุชุตููู ูุงูุฎุฏูุงุช ุงูุชุนููููุฉ 2025</span>
    </a>
</footer>

<script>
    // ุชู ูุณุฎ ุงูููุฏ ุงูุฃุตูู ูุฅุถุงูุฉ ููุทู ุงูุชุจููุจุงุช ูุงูููุงุกูุฉ ููุท
    document.addEventListener('DOMContentLoaded', function () {
    
    // --- Data Definitions ---
    const createGenericProgramData = (programName) => {
        const stages = ['primary', 'upper-primary', 'middle', 'high-2'];
        const stageNames = { 'primary': 'ุงูุตููู ุงูุฃูููุฉ', 'upper-primary': 'ุงูุตููู ุงูุนููุง', 'middle': 'ุงููุฑุญูุฉ ุงููุชูุณุทุฉ', 'high-2': 'ุงููุฑุญูุฉ ุงูุซุงูููุฉ' };
        const sessionCount = 8;
        const duration = `${sessionCount * 45} ุฏูููุฉ (${sessionCount} ุญุตุต)`;
        const details = Array.from({ length: sessionCount }, (_, i) => ({
            title: `ุงูุญุตุฉ ${i + 1}`,
            content: 'ุณูุชู ุชุญุฏูุซ ุงููููุน ุจุนุฏ ุตุฏูุฑ ุงูุฃุฏูุฉ ุงูุฎุงุตุฉ ุจุงูุจุฑุงูุฌ ูู ุงููุฑูุฒ ุงููุทูู ููููุงูุฌ'
        }));
        let programData = { name: programName, field: "ุงูุซูุงูุฉ ูุงููููู", stages: {} };
        stages.forEach(stage => {
            programData.stages[stage] = {
                name: `${programName} โ ${stageNames[stage]}`, sessions: sessionCount, duration: duration, target: `ุทูุงุจ ${stageNames[stage]}`, location: "ูุงุนุงุช ุงููุดุงุท / ุงููุณุฑุญ ุงููุฏุฑุณู", tools: "ุฃุฏูุงุช ูููุฉ ูุชููุนุฉ ุญุณุจ ุทุจูุนุฉ ุงูุจุฑูุงูุฌ",
                learningOutcomes: "ุณูุชู ุชุญุฏูุซ ุงููููุน ุจุนุฏ ุตุฏูุฑ ุงูุฃุฏูุฉ ุงูุฎุงุตุฉ ุจุงูุจุฑุงูุฌ ูู ุงููุฑูุฒ ุงููุทูู ููููุงูุฌ", assessmentMethods: "ุงูููุงุญุธุฉุ ููู ุงูุฅูุฌุงุฒุ ุชูููู ุงูุฃูุฑุงู", details: details,
                executionSummary: "ุณูุชู ุชุญุฏูุซ ุงููููุน ุจุนุฏ ุตุฏูุฑ ุงูุฃุฏูุฉ ุงูุฎุงุตุฉ ุจุงูุจุฑุงูุฌ ูู ุงููุฑูุฒ ุงููุทูู ููููุงูุฌ"
            };
        });
        return programData;
    };

    const programDefinitions = {
        'culture_arts': {
            field: "ุงูุซูุงูุฉ ูุงููููู",
            programs: { 'seventh_art_cinema': "ุงููู ุงูุณุงุจุน (ุงูุณูููุง)", 'art_gardens': "ุญุฏุงุฆู ุงููู", 'saudi_fashion': "ุงูุฃุฒูุงุก ุงูุณุนูุฏูุฉ", 'media_culture': "ุงูุซูุงูุฉ ุงูุฅุนูุงููุฉ", 'contemporary_heritage_designs': "ุชุตุงููู ุชุฑุงุซูุฉ ูุนุงุตุฑุฉ", 'theatrical_arts': "ุงููููู ุงููุณุฑุญูุฉ", 'musical_program_anthems': "ุงูุจุฑูุงูุฌ ุงูููุณููู (ุงูุฃูุงุดูุฏ ุงููุทููุฉ)", 'visual_stories': "ุญูุงูุงุช ูุฑุฆูุฉ" }
        }
    };
    
    let fieldsData = {};
    Object.keys(programDefinitions.culture_arts.programs).forEach(progKey => {
        const progName = programDefinitions.culture_arts.programs[progKey];
        fieldsData[progKey] = createGenericProgramData(progName);
    });

    // --- Inject Specific Data (Paste your long data here) ---
    // (ุชู ุงุฎุชุตุงุฑ ุงูุจูุงูุงุช ููุง ููุชูุถูุญุ ุณูุชู ุงุณุชุฎุฏุงู ุงูุจูุงูุงุช ุงูุฃุตููุฉ)
    // 1. ุงููููู ุงููุณุฑุญูุฉ (ููุฌูุฏุฉ ูู ุงูููุฏ ุงูุฃุตูู)
    fieldsData.theatrical_arts.stages['primary'] = {
        name: "ุงููููู ุงููุณุฑุญูุฉ", sessions: 8, duration: "ูฃูฆู ุฏูููุฉ (ูจ ุญุตุต)", target: "ุงูุตููู ุงูุฃูููุฉ", location: "ุงููุณุฑุญ ุงููุฏุฑุณู โ ุงููุตูู ุงูุฏุฑุงุณู โ ุงูููุงุก ุงูุฏุงุฎูู ูููุฏุฑุณุฉ", tools: "ููุจูุฑุงุช ุตูุชุ ุฅุถุงุกุฉุ ูุงููุฑุงุช ุงูุฌูุงูุงุชุ ุจุฑุงูุฌ ุตูุชูุงุช ูููุคุซุฑุงุช ุงูุตูุชูุฉ.",
        learningOutcomes: "โข ุชุฃุฏูุฉ ูุดูุฏ ูุตูุฑ ูู ุงุฎุชูุงุฑ ุงูุทุงูุจ ุฃูุงู ุงูุฌูููุฑุ ููุชุนุจูุฑ ุนู ููุฑุฉ ูุจุชูุฑุฉ ูุงุฏูุฉ.\nโข ุงูุชุนุจูุฑ ุนู ุงููููู ูุงูุงูุชูุงูุงุช ุงูุดุฎุตูุฉ ูู ุฎูุงู ุชูุฏูู ูุดูุฏ ูุณุฑุญู ูุตูุฑ.\nโข ุงููุดุงุฑูุฉ ูุน ุงูุฃูุฑุงู ูู ุชูุฏูู ุนุฑุถ ูุณุฑุญู ูุตูุฑุ ูุฅุจุฑุงุฒ ุงูููุงูุจ ูุงููุฏุฑุงุช ุงูุฅุจุฏุงุนูุฉ.\nโข ุงูููุงูุดูุฉ ููุน ุงูุฃููุฑุงู ุญููู ุนูุงุตูุฑ ุนูุฑุถ ูุณูุฑุญู ุจุนูุฏ ูุดูุงูุฏุชููุ ุจุชูุถููุญ ุงูุฌูุงููุจ ุงูููุถููุฉ ููู .\nโข ุงูุชุนูุฑู ุนููู ุงูุนูุงุตูุฑ ุงูุฃุฏุงุฆููุฉ ููู ุงูุฃุนููุงู ุงููุณูุฑุญูุฉ ุงููุตููุฑุฉุ ูููู ุงูููุฏุฑุงุช ูุงููููุงุฑุงุช ุงูููููุฉ ูุงูุดุฎุตูุฉ.\nโข ุงูุชูุงุตู ุจูุงุนููุฉ ูุน ุงูุฃูุฑุงู ุฃุซูุงุก ุงููุดุงุฑูุฉ ูู ุนุฑุถ ูุณุฑุญู ูุตูุฑ.",
        assessmentMethods: "โข ุจุทุงูุฉ ููุงุญุธุฉ ููุงุฆู ุชูุฏูุฑ ุชุญููู ุงูุฎุจุฑุงุก .\nโข ุชูููู ุงูุฃูุฑุงู.",
        executionSummary: "ุชู ุชูููุฐ ุงูุจุฑูุงูุฌ ุนุจุฑ ุฃูุดุทุฉ ูุชุฏุฑุฌุฉุ ุจุฏุฃุช ุจุงูุชููุฆุฉ ูุณุฑุฏ ุงููุตุตุ ุซู ุชุญููููุง ููุดุงูุฏ ุชูุซูููุฉ. ุชุถููุช ุงูุฎุทุฉ ูุฑุด ุนูู ููุชุฏุฑูุจ ุนูู ุงูุตูุช ูุงูุฌุณุฏุ ูุตูููุง ูุชูุฏูู ุนุฑุถ ุตูููุ ูุงุฎุชุชูุช ุจููุงุด ูุชูุซูู ููุชุฌุฑุจุฉ.",
        details: [
            { title: 'ุชููุฆุฉ: ูุตุฉ ุชูููุฏูุฉ ุญููุฉ', content: '1-  ูุจุฏุฃ ุงููุนููู ุจุณุฑุฏ ูุตุฉ ูุตูุฑุฉ ุจุฃุณููุจ ูุดููู ููุคุซููุฑ ุตูุชููุง ูุน ุชุนุจูุฑุงุช ูุฌู ูุฌุณุฏ ูุฌุฐุจ ุงูุชุจุงู ุงูุฃุทูุงู ูุจูุงุก ุชุฌุฑุจุฉ ุณูุนูุฉ-ุจุตุฑูุฉ. ุฃูุซูุฉ ููุชุฑุญุฉ ูู ููุฑูุฑ ูุบุชู: (ุนุงุฏู ูู ุงูุทุงุฆุฑุฉ)  (ุงูุฅูุซุงุฑ) (ุงูุฃููุงุฑ ุงูุตูุงุนูุฉ) ุจุนุฏ ุงูุณุฑุฏุ ููุชูู ูุจุงุดุฑุฉู ููุฃูุดุทุฉ. ุงูุชุณุงูุญ\n2-  ูุต ููุธูุฑ ุงูุชุณุงูุญ ุฏุงุฎู ุงููุดุงุท: (ุฃูุง ุขุณู ุฅู ุณุจููุชููู - ุชูุถู ูุจูู - ุฃูุตุบู ููุฑุฃูู ุญุชู ูู ุงุฎุชููุชู ูุนู )  ุซู ููุฑูุฑูุง ุงูุฃุทูุงู ุชูุซูููุง. ุงูุชุณุงูุญ\n3-  ุฃุณุฆูุฉ ููู ูู ุงูุฏููู: ูู ุงูุดุฎุตูุงุชุ ููู ุจุฏุฃุช ุงููุตุฉุ ูุงุฐุง ุญุฏุซ ูู ุงูููุชุตูุ ููู ุงูุชูุชุ ูุง ุงูุชุญุฏูู ุงูุฐู ูุงุฌูู ุงูุจุทูุ .  ุงูุงูุถุจุงุท\n4-  ูุชูู ุงูุฌููุน ุนูู ยซููุซุงู ุงูุนุฑุถยป: ูุง ุณุฎุฑูุฉ/ูุง ููุงุทุนุฉ/ุงูุชุธุงุฑ ุงูุฏูุฑ - ูููุนููู ูู ุงูุตู . ุงูุฃูุงูุฉ' },
            { title: 'ูู ุงูุณุฑุฏ ุฅูู ุงูุชูุซูู', content: '1-  ูุฎุชุงุฑ ุงููุนููู ููุฑุฉ ูู ุงููุตุฉ ุงููุณููุนุฉ (ุงุนุชุฐุงุฑ/ุตูุญ/ุชูุงุณู ุฏูุฑ) ููุญููููุง ููุญูุงุฑู ูุตูุฑ:  ุฃุนุชุฐุฑ ูุฃููู ุงุณุชุนุฌูุช - ููุง ูุชูุงุณู ุงูููุช .  ุงูุชุณุงูุญ\n2-  ุชุญุฏูุฏ ููุงูุน ุงููููู ูุงูููุงู ุจุนูุงูุงุช ุฃุฑุถูุฉ ูุงูุชุฒุงู ุฅุดุงุฑุฉ ุงูุจุฏุก ุงูุงูุถุจุงุท\n3-  ุชุฏุฑูุจ ุตูุชู ูููุฌููู ุนูู ุฌูู ุงูุฃุฏุจ: ยซุดูุฑูุง ูุฅุตุบุงุฆูยปุ ยซุฌุฑุจููุง ุทุฑููุชู ุงูุขูยซ ุงูุนุฒููุฉ\n4-   ุชุจุงุฏู ุงูุฃุฏูุงุฑ ูุฅุธูุงุฑ ุชูุจูู ุงุฎุชูุงู ุงูุฒููุงุก  . ุงูุชุนุงูู' },
            { title: 'ูุดูุฏ ุตุงูุช ุนู ุงููุณุงูุฏุฉ', content: '1-  ูุดูุฏ ยซุฃุณูุทู ุฃููุงููู - ุฃูุณุงุนูุฏูู ูุฃุจุชุณูยป ูุคุฏููู ุจูุง ููุงู .ุงูุชุนุงูู\n2-  ุฅููุงุกุงุช ุงุญุชุฑุงู: ยซุงุณุชุฃุฐู/ุชูุถููยป ูุถุจุท ุงูุณููู ุฏูู ููุธ ยซ .ุงูุงูุถุจุงุท\n3-  ุจุนุฏ ูู ุนุฑุถุ ุฌููุฉ ูุทููุฉ ุฅูุฒุงููุฉ: ยซุฃุนุฌุจูู ูุทููู ุนูุฏูุงยซ.  ุงูุชุณุงูุญ\n4-  ุชูุซูู ุนูู ููุญุฉ ยซูุง ุฃุชูููุง/ูุง ููุญุณููยซ.  ุงูุฃูุงูุฉ' },
            { title: 'ููุงูุฉ ุจุฏููุฉ ุจููููุณ ูุทูู', content: '1-  ุนุตู ุฐููู ููููุงูุงุช ููุธูุฑ ุฑูุญ ุงููุฏุฑุณุฉ ูุงูุฃุณุฑุฉ (ุญูุงูุฉ ุงูููุชููุงุช/ุชุญูุฉ ุงูุนูู) ุงูุงูุชูุงุก ุงููุทูู\n2-   ูุชุงุจุฉ ููุงูุฉ ุชูููู ุงูุฎูุงู ุจู ยซุญููู ูุณุทยป: ยซูุชูุงุณู ุงููุนุจยป ุงูุชุณุงูุญ\n3-   ุจุทุงูุงุช ุฃุฏูุงุฑ: ยซูุณุชุฃุฐู/ููุฌูุจ/ูููุชุฑูุญ ุญูยป ุงูุฃูุงูุฉ\n4-   ุจุฑููุฉ ุงุชูุงู ุจุฌููู:  ยซุงุชูููุงุ ุงุชูููุงยป  ุงูุงูุถุจุงุท' },
            { title: 'ุจุฑููุฉ 1: ุตูุช/ุฌุณุฏ', content: '1-  ุฑูุชูู ุงูุชุชุงุญู ุซุงุจุช:  ุชูููุณ โ ุฅุดุงุฑุฉ - ุจุฏุก . ุงูุงูุถุจุงุท\n2-   ุฌููู ุณููููุฉ ุฏุงุฎู ุงูุฃุฏุงุก: ยซุฃูุฑุญ ุจูุฌุงุญู ูุซู ูุฌุงุญูยป  ุงูุชุณุงูุญ\n3-  ุชุฏููุฑ ุฃุฏูุงุฑ ูุฏุนู ุงูุฎุฌูููู ุจุฎุทูุงุช ุตุบูุฑุฉ ูุชุนุฒูุฒ ููุธู . ุงูุชุนุงูู' },
            { title: 'ุจุฑููุฉ 2 + ุชูุซูู ุงูููุงู', content: '1-  ุฅุนุงุฏุฉ ุงููุดูุฏ ูุงูููุง ูุน ุชุตุญูุญ ูุงุฏุฆ: ยซูุญุงูู ูุฑูุฉ ุฃุฎุฑู - ูุง ูุณุชุณููยป  ุงูุนุฒููุฉ\n2-   ุชูุธูู ุงูุฏุฎูู/ุงูุฎุฑูุฌ:   ยซุฃุชุญุฑูู ุจุนุฏ ุฌููุชูยป  ุงูุงูุถุจุงุท\n3-   ุชุฐููุฑ ุณูุงูุฉ: ุงูุนูู ุถูู ุงูุญุฏูุฏ ุงููุฑุณููุฉ ูุญูุธ ุงูุฃุฏูุงุช ุงูุฃูุงูุฉ' },
            { title: 'ุงูุนุฑุถ ุงูุตููู', content: '1-  ููุฏููุฉ ููููุฉ: ยซุงูููู ููุธูุฑ ููู ูุฎุชูู ุจูุทูยป   ุงูุชุณุงูุญ\n2- ) ุงูุชุฒุงู ุชุฑุชูุจ ุงูููุฑูู ูุงูููุช ูุฅุชูููุช ุงูุฌูููุฑ ) ุงูุงูุถุจุงุท\n3-  ุฌููุฉ ุฎุชุงููุฉ ููุญูุฏุฉ: ยซูุฎุชููโฆ ููู ูุฌุฏ ุญููุง ูุนูุงยป  ุงูุชุนุงูู' },
            { title: 'ููุงุด ูุชูุซูู', content: '1-  ุจุทุงูุฉ ุชุฃููู: ยซููุทูู ููุชูู ุงูููู / ุณูููู ุญุณูู ูุนูุชููยป   ุงูุฃูุงูุฉ\n2-   ุซูุงุซุฉ ููุงูู ุชุณุงูุญ ุฑุขูุง ุงูุทูุงุจ ูู ุงูุนุฑูุถ . ุงูุชุณุงูุญ\n3-  ยซูุนุฏ ุชุทุจููยป ูู ุงููุณุญุฉ/ุงูุจูุช ูุน ุชูููุน ุฌูุงุนู  . ุงูุงูุชูุงุก ุงููุทูู' }
        ],
        strengths: "โข ูุดุงุท ูุตุตู-ุชูุซููู ุจุณูุท ูุฑูุน ุฌุงุฐุจูุฉ ุงูุจูุฆุฉ ุงููุฏุฑุณูุฉ ููุบุฑุณ ุงูุณููู ุงูุฅูุฌุงุจู.\nโข ูุงุจู ูุฅุดุฑุงู ุงูุฃุณุฑุฉ (ูุดุงูุฏุฉ/ุชูุซูู) ูุชุนุฒูุฒ ุงูุดุฑุงูุฉ ุงููุฌุชูุนูุฉ.", difficulties: "โข ุชูุงูุช ุงูุฌุฑุฃุฉ ุงููุบููุฉ/ุงูุญุฑููุฉ.\nโข ุฅุฏุงุฑุฉ ููุช ุงูุจุฑููุงุช ุงููุตูุฑุฉ.",
        achievements: "โข ูุดูุฏ ุตููู ูุตูุฑ ูุนูุณ ุณููููุง ุฅูุฌุงุจููุง (ุชุณุงูุญ/ุชุนุงูู).\nโข ุชุญุณูู ููุญูุธ ูู ุงูุงูุถุจุงุท ูุงูุชุนุงูู ููุซูู ุจุจุทุงูุงุช ุงูููุงุญุธุฉ.", remedial_actions: "โข ุชุฏููุฑ ุงูุฃุฏูุงุฑ ูุน ุฌููู ุฏุนู ุฅูุฌุงุจูุฉ ููุฎุฌูููู.\nโข ุฑูุชูู ุฅุญูุงุก ุซุงุจุช (ุตูุช/ุฌุณุฏ) ูุถุจุท ุงูุฅููุงุน ูุงูุชุฑููุฒ."
    };
    
    // (ูุฌุจ ููุง ูุณุฎ ุจููุฉ ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจุงูุจุฑุงูุฌ ูู ุงูููุฏ ุงูุณุงุจู: ุงูุฃุฒูุงุก ุงูุณุนูุฏูุฉุ ุงูุจุฑูุงูุฌ ุงูููุณูููุ ุงูุซูุงูุฉ ุงูุฅุนูุงููุฉุ ุชุตุงููู ุชุฑุงุซูุฉ...)
    // ... [ุชู ุญุฐููุง ุงุฎุชุตุงุฑุงู ูู ุงูุฑุฏุ ูุฌุจ ุฃู ุชููู ููุฌูุฏุฉ ูู ุงูููู ุงูููุงุฆู] ...

    // --- Calendar Data ---
    const weeksS1_Other = {
        'week1': { name: 'ุงูุฃุณุจูุน ุงูุฃูู', semester: 1, startDate: '1 / 3', endDate: '5 / 3', days: { 'ุงูุฃุญุฏ': '1 / 3', 'ุงูุงุซููู': '2 / 3', 'ุงูุซูุงุซุงุก': '3 / 3', 'ุงูุฃุฑุจุนุงุก': '4 / 3', 'ุงูุฎููุณ': '5 / 3' } },
        'week2': { name: 'ุงูุฃุณุจูุน ุงูุซุงูู', semester: 1, startDate: '8 / 3', endDate: '12 / 3', days: { 'ุงูุฃุญุฏ': '8 / 3', 'ุงูุงุซููู': '9 / 3', 'ุงูุซูุงุซุงุก': '10 / 3', 'ุงูุฃุฑุจุนุงุก': '11 / 3', 'ุงูุฎููุณ': '12 / 3' } },
        'week3': { name: 'ุงูุฃุณุจูุน ุงูุซุงูุซ', semester: 1, startDate: '15 / 3', endDate: '19 / 3', days: { 'ุงูุฃุญุฏ': '15 / 3', 'ุงูุงุซููู': '16 / 3', 'ุงูุซูุงุซุงุก': '17 / 3', 'ุงูุฃุฑุจุนุงุก': '18 / 3', 'ุงูุฎููุณ': '19 / 3' } },
        'week4': { name: 'ุงูุฃุณุจูุน ุงูุฑุงุจุน', semester: 1, startDate: '22 / 3', endDate: '26 / 3', days: { 'ุงูุฃุญุฏ': '22 / 3', 'ุงูุงุซููู': '23 / 3', 'ุงูุซูุงุซุงุก': '24 / 3', 'ุงูุฃุฑุจุนุงุก': '25 / 3', 'ุงูุฎููุณ': '26 / 3' } },
        'week5': { name: 'ุงูุฃุณุจูุน ุงูุฎุงูุณ', semester: 1, startDate: '29 / 3', endDate: '3 / 4', days: { 'ุงูุฃุญุฏ': '29 / 3', 'ุงูุงุซููู': '30 / 3', 'ุงูุซูุงุซุงุก': '1 / 4', 'ุงูุฃุฑุจุนุงุก': '2 / 4', 'ุงูุฎููุณ': '3 / 4' }, specialDays: { '1 / 4': { name: 'ุฅุฌุงุฒุฉ ุงูููู ุงููุทูู', type: 'holiday', color: 'green' } } },
        'week6': { name: 'ุงูุฃุณุจูุน ุงูุณุงุฏุณ', semester: 1, startDate: '6 / 4', endDate: '10 / 4', days: { 'ุงูุฃุญุฏ': '6 / 4', 'ุงูุงุซููู': '7 / 4', 'ุงูุซูุงุซุงุก': '8 / 4', 'ุงูุฃุฑุจุนุงุก': '9 / 4', 'ุงูุฎููุณ': '10 / 4' } },
        'week7': { name: 'ุงูุฃุณุจูุน ุงูุณุงุจุน', semester: 1, startDate: '13 / 4', endDate: '17 / 4', days: { 'ุงูุฃุญุฏ': '13 / 4', 'ุงูุงุซููู': '14 / 4', 'ุงูุซูุงุซุงุก': '15 / 4', 'ุงูุฃุฑุจุนุงุก': '16 / 4', 'ุงูุฎููุณ': '17 / 4' } },
        'week8': { name: 'ุงูุฃุณุจูุน ุงูุซุงูู', semester: 1, startDate: '20 / 4', endDate: '24 / 4', days: { 'ุงูุฃุญุฏ': '20 / 4', 'ุงูุงุซููู': '21 / 4', 'ุงูุซูุงุซุงุก': '22 / 4', 'ุงูุฃุฑุจุนุงุก': '23 / 4', 'ุงูุฎููุณ': '24 / 4' }, specialDays: { '20 / 4': { name: 'ุฅุฌุงุฒุฉ ุฅุถุงููุฉ', type: 'holiday', color: 'red' } } },
        'week9': { name: 'ุงูุฃุณุจูุน ุงูุชุงุณุน', semester: 1, startDate: '27 / 4', endDate: '1 / 5', days: { 'ุงูุฃุญุฏ': '27 / 4', 'ุงูุงุซููู': '28 / 4', 'ุงูุซูุงุซุงุก': '29 / 4', 'ุงูุฃุฑุจุนุงุก': '30 / 4', 'ุงูุฎููุณ': '1 / 5' } },
        'week10': { name: 'ุงูุฃุณุจูุน ุงูุนุงุดุฑ', semester: 1, startDate: '4 / 5', endDate: '8 / 5', days: { 'ุงูุฃุญุฏ': '4 / 5', 'ุงูุงุซููู': '5 / 5', 'ุงูุซูุงุซุงุก': '6 / 5', 'ุงูุฃุฑุจุนุงุก': '7 / 5', 'ุงูุฎููุณ': '8 / 5' } },
        'week11': { name: 'ุงูุฃุณุจูุน ุงูุญุงุฏู ุนุดุฑ', semester: 1, startDate: '11 / 5', endDate: '15 / 5', days: { 'ุงูุฃุญุฏ': '11 / 5', 'ุงูุงุซููู': '12 / 5', 'ุงูุซูุงุซุงุก': '13 / 5', 'ุงูุฃุฑุจุนุงุก': '14 / 5', 'ุงูุฎููุณ': '15 / 5' } },
        'week12': { name: 'ุงูุฃุณุจูุน ุงูุซุงูู ุนุดุฑ', semester: 1, startDate: '18 / 5', endDate: '22 / 5', days: { 'ุงูุฃุญุฏ': '18 / 5', 'ุงูุงุซููู': '19 / 5', 'ุงูุซูุงุซุงุก': '20 / 5', 'ุงูุฃุฑุจุนุงุก': '21 / 5', 'ุงูุฎููุณ': '22 / 5' } },
        'week13': { name: 'ุงูุฃุณุจูุน ุงูุซุงูุซ ุนุดุฑ', semester: 1, startDate: '25 / 5', endDate: '29 / 5', days: { 'ุงูุฃุญุฏ': '25 / 5', 'ุงูุงุซููู': '26 / 5', 'ุงูุซูุงุซุงุก': '27 / 5', 'ุงูุฃุฑุจุนุงุก': '28 / 5', 'ุงูุฎููุณ': '29 / 5' } },
        'autumn_break': { name: 'ุฅุฌุงุฒุฉ ุงูุฎุฑูู', semester: 1, startDate: '30 / 5', endDate: '8 / 6', days: {}, holidayDetails: 'ุชุจุฏุฃ ุจููุงูุฉ ุฏูุงู ุงูุฎููุณ 05/29 ุฅูู ุงูุณุจุช 06/08' },
        'week14': { name: 'ุงูุฃุณุจูุน ุงูุฑุงุจุน ุนุดุฑ', semester: 1, startDate: '9 / 6', endDate: '13 / 6', days: { 'ุงูุฃุญุฏ': '9 / 6', 'ุงูุงุซููู': '10 / 6', 'ุงูุซูุงุซุงุก': '11 / 6', 'ุงูุฃุฑุจุนุงุก': '12 / 6', 'ุงูุฎููุณ': '13 / 6' } },
        'week15': { name: 'ุงูุฃุณุจูุน ุงูุฎุงูุณ ุนุดุฑ', semester: 1, startDate: '16 / 6', endDate: '20 / 6', days: { 'ุงูุฃุญุฏ': '16 / 6', 'ุงูุงุซููู': '17 / 6', 'ุงูุซูุงุซุงุก': '18 / 6', 'ุงูุฃุฑุจุนุงุก': '19 / 6', 'ุงูุฎููุณ': '20 / 6' }, specialDays: { '20 / 6': { name: 'ุฅุฌุงุฒุฉ ุฅุถุงููุฉ', type: 'holiday', color: 'red' } } },
        'week16': { name: 'ุงูุฃุณุจูุน ุงูุณุงุฏุณ ุนุดุฑ', semester: 1, startDate: '23 / 6', endDate: '27 / 6', days: { 'ุงูุฃุญุฏ': '23 / 6', 'ุงูุงุซููู': '24 / 6', 'ุงูุซูุงุซุงุก': '25 / 6', 'ุงูุฃุฑุจุนุงุก': '26 / 6', 'ุงูุฎููุณ': '27 / 6' }, specialDays: { '23 / 6': { name: 'ุฅุฌุงุฒุฉ ุฅุถุงููุฉ', type: 'holiday', color: 'red' } } },
        'week17': { name: 'ุงูุฃุณุจูุน ุงูุณุงุจุน ุนุดุฑ', semester: 1, startDate: '1 / 7', endDate: '5 / 7', days: { 'ุงูุฃุญุฏ': '1 / 7', 'ุงูุงุซููู': '2 / 7', 'ุงูุซูุงุซุงุก': '3 / 7', 'ุงูุฃุฑุจุนุงุก': '4 / 7', 'ุงูุฎููุณ': '5 / 7' } },
        'week18': { name: 'ุงูุฃุณุจูุน ุงูุซุงูู ุนุดุฑ', semester: 1, startDate: '8 / 7', endDate: '12 / 7', days: { 'ุงูุฃุญุฏ': '8 / 7', 'ุงูุงุซููู': '9 / 7', 'ุงูุซูุงุซุงุก': '10 / 7', 'ุงูุฃุฑุจุนุงุก': '11 / 7', 'ุงูุฎููุณ': '12 / 7' } },
        'exams': { name: 'ุงูุงุฎุชุจุงุฑุงุช', semester: 1, startDate: '15 / 7', endDate: '19 / 7', days: {} }
    };
    const weeksS1_Western = {
        'week1': { name: 'ุงูุฃุณุจูุน ุงูุฃูู', semester: 1, startDate: '8 / 3', endDate: '12 / 3', days: { 'ุงูุฃุญุฏ': '8 / 3', 'ุงูุงุซููู': '9 / 3', 'ุงูุซูุงุซุงุก': '10 / 3', 'ุงูุฃุฑุจุนุงุก': '11 / 3', 'ุงูุฎููุณ': '12 / 3' } },
        'week2': { name: 'ุงูุฃุณุจูุน ุงูุซุงูู', semester: 1, startDate: '15 / 3', endDate: '19 / 3', days: { 'ุงูุฃุญุฏ': '15 / 3', 'ุงูุงุซููู': '16 / 3', 'ุงูุซูุงุซุงุก': '17 / 3', 'ุงูุฃุฑุจุนุงุก': '18 / 3', 'ุงูุฎููุณ': '19 / 3' } },
        'week3': { name: 'ุงูุฃุณุจูุน ุงูุซุงูุซ', semester: 1, startDate: '22 / 3', endDate: '26 / 3', days: { 'ุงูุฃุญุฏ': '22 / 3', 'ุงูุงุซููู': '23 / 3', 'ุงูุซูุงุซุงุก': '24 / 3', 'ุงูุฃุฑุจุนุงุก': '25 / 3', 'ุงูุฎููุณ': '26 / 3' } },
        'week4': { name: 'ุงูุฃุณุจูุน ุงูุฑุงุจุน', semester: 1, startDate: '29 / 3', endDate: '3 / 4', days: { 'ุงูุฃุญุฏ': '29 / 3', 'ุงูุงุซููู': '30 / 3', 'ุงูุซูุงุซุงุก': '1 / 4', 'ุงูุฃุฑุจุนุงุก': '2 / 4', 'ุงูุฎููุณ': '3 / 4' }, specialDays: { '1 / 4': { name: 'ุฅุฌุงุฒุฉ ุงูููู ุงููุทูู', type: 'holiday', color: 'green' } } },
        'week5': { name: 'ุงูุฃุณุจูุน ุงูุฎุงูุณ', semester: 1, startDate: '6 / 4', endDate: '10 / 4', days: { 'ุงูุฃุญุฏ': '6 / 4', 'ุงูุงุซููู': '7 / 4', 'ุงูุซูุงุซุงุก': '8 / 4', 'ุงูุฃุฑุจุนุงุก': '9 / 4', 'ุงูุฎููุณ': '10 / 4' } },
        'week6': { name: 'ุงูุฃุณุจูุน ุงูุณุงุฏุณ', semester: 1, startDate: '13 / 4', endDate: '17 / 4', days: { 'ุงูุฃุญุฏ': '13 / 4', 'ุงูุงุซููู': '14 / 4', 'ุงูุซูุงุซุงุก': '15 / 4', 'ุงูุฃุฑุจุนุงุก': '16 / 4', 'ุงูุฎููุณ': '17 / 4' } },
        'week7': { name: 'ุงูุฃุณุจูุน ุงูุณุงุจุน', semester: 1, startDate: '20 / 4', endDate: '24 / 4', days: { 'ุงูุฃุญุฏ': '20 / 4', 'ุงูุงุซููู': '21 / 4', 'ุงูุซูุงุซุงุก': '22 / 4', 'ุงูุฃุฑุจุนุงุก': '23 / 4', 'ุงูุฎููุณ': '24 / 4' }, specialDays: { '20 / 4': { name: 'ุฅุฌุงุฒุฉ ุฅุถุงููุฉ', type: 'holiday', color: 'red' } } },
        'week8': { name: 'ุงูุฃุณุจูุน ุงูุซุงูู', semester: 1, startDate: '27 / 4', endDate: '1 / 5', days: { 'ุงูุฃุญุฏ': '27 / 4', 'ุงูุงุซููู': '28 / 4', 'ุงูุซูุงุซุงุก': '29 / 4', 'ุงูุฃุฑุจุนุงุก': '30 / 4', 'ุงูุฎููุณ': '1 / 5' } },
        'week9': { name: 'ุงูุฃุณุจูุน ุงูุชุงุณุน', semester: 1, startDate: '4 / 5', endDate: '8 / 5', days: { 'ุงูุฃุญุฏ': '4 / 5', 'ุงูุงุซููู': '5 / 5', 'ุงูุซูุงุซุงุก': '6 / 5', 'ุงูุฃุฑุจุนุงุก': '7 / 5', 'ุงูุฎููุณ': '8 / 5' } },
        'week10': { name: 'ุงูุฃุณุจูุน ุงูุนุงุดุฑ', semester: 1, startDate: '11 / 5', endDate: '15 / 5', days: { 'ุงูุฃุญุฏ': '11 / 5', 'ุงูุงุซููู': '12 / 5', 'ุงูุซูุงุซุงุก': '13 / 5', 'ุงูุฃุฑุจุนุงุก': '14 / 5', 'ุงูุฎููุณ': '15 / 5' } },
        'week11': { name: 'ุงูุฃุณุจูุน ุงูุญุงุฏู ุนุดุฑ', semester: 1, startDate: '18 / 5', endDate: '22 / 5', days: { 'ุงูุฃุญุฏ': '18 / 5', 'ุงูุงุซููู': '19 / 5', 'ุงูุซูุงุซุงุก': '20 / 5', 'ุงูุฃุฑุจุนุงุก': '21 / 5', 'ุงูุฎููุณ': '22 / 5' } },
        'week12': { name: 'ุงูุฃุณุจูุน ุงูุซุงูู ุนุดุฑ', semester: 1, startDate: '25 / 5', endDate: '29 / 5', days: { 'ุงูุฃุญุฏ': '25 / 5', 'ุงูุงุซููู': '26 / 5', 'ุงูุซูุงุซุงุก': '27 / 5', 'ุงูุฃุฑุจุนุงุก': '28 / 5', 'ุงูุฎููุณ': '29 / 5' } },
        'autumn_break': { name: 'ุฅุฌุงุฒุฉ ุงูุฎุฑูู', semester: 1, startDate: '30 / 5', endDate: '8 / 6', days: {}, holidayDetails: 'ุชุจุฏุฃ ุจููุงูุฉ ุฏูุงู ุงูุฎููุณ 05/29 ุฅูู ุงูุณุจุช 06/08' },
        'week13': { name: 'ุงูุฃุณุจูุน ุงูุซุงูุซ ุนุดุฑ', semester: 1, startDate: '9 / 6', endDate: '13 / 6', days: { 'ุงูุฃุญุฏ': '9 / 6', 'ุงูุงุซููู': '10 / 6', 'ุงูุซูุงุซุงุก': '11 / 6', 'ุงูุฃุฑุจุนุงุก': '12 / 6', 'ุงูุฎููุณ': '13 / 6' } },
        'week14': { name: 'ุงูุฃุณุจูุน ุงูุฑุงุจุน ุนุดุฑ', semester: 1, startDate: '16 / 6', endDate: '20 / 6', days: { 'ุงูุฃุญุฏ': '16 / 6', 'ุงูุงุซููู': '17 / 6', 'ุงูุซูุงุซุงุก': '18 / 6', 'ุงูุฃุฑุจุนุงุก': '19 / 6', 'ุงูุฎููุณ': '20 / 6' }, specialDays: { '20 / 6': { name: 'ุฅุฌุงุฒุฉ ุฅุถุงููุฉ', type: 'holiday', color: 'red' } } },
        'week15': { name: 'ุงูุฃุณุจูุน ุงูุฎุงูุณ ุนุดุฑ', semester: 1, startDate: '23 / 6', endDate: '27 / 6', days: { 'ุงูุฃุญุฏ': '23 / 6', 'ุงูุงุซููู': '24 / 6', 'ุงูุซูุงุซุงุก': '25 / 6', 'ุงูุฃุฑุจุนุงุก': '26 / 6', 'ุงูุฎููุณ': '27 / 6' }, specialDays: { '23 / 6': { name: 'ุฅุฌุงุฒุฉ ุฅุถุงููุฉ', type: 'holiday', color: 'red' } } },
        'week16': { name: 'ุงูุฃุณุจูุน ุงูุณุงุฏุณ ุนุดุฑ', semester: 1, startDate: '1 / 7', endDate: '5 / 7', days: { 'ุงูุฃุญุฏ': '1 / 7', 'ุงูุงุซููู': '2 / 7', 'ุงูุซูุงุซุงุก': '3 / 7', 'ุงูุฃุฑุจุนุงุก': '4 / 7', 'ุงูุฎููุณ': '5 / 7' } },
        'week17': { name: 'ุงูุฃุณุจูุน ุงูุณุงุจุน ุนุดุฑ', semester: 1, startDate: '8 / 7', endDate: '12 / 7', days: { 'ุงูุฃุญุฏ': '8 / 7', 'ุงูุงุซููู': '9 / 7', 'ุงูุซูุงุซุงุก': '10 / 7', 'ุงูุฃุฑุจุนุงุก': '11 / 7', 'ุงูุฎููุณ': '12 / 7' } },
        'exams': { name: 'ุงูุงุฎุชุจุงุฑุงุช', semester: 1, startDate: '15 / 7', endDate: '19 / 7', days: {} }
    };
    const weeksS2_Other = {
        's2_week1': { name: 'ุงูุฃุณุจูุน ุงูุฃูู', semester: 2, startDate: '29 / 07', endDate: '03 / 08', days: { 'ุงูุฃุญุฏ': '29 / 07', 'ุงูุงุซููู': '30 / 07', 'ุงูุซูุงุซุงุก': '01 / 08', 'ุงูุฃุฑุจุนุงุก': '02 / 08', 'ุงูุฎููุณ': '03 / 08' } },
        's2_week2': { name: 'ุงูุฃุณุจูุน ุงูุซุงูู', semester: 2, startDate: '06 / 08', endDate: '10 / 08', days: { 'ุงูุฃุญุฏ': '06 / 08', 'ุงูุงุซููู': '07 / 08', 'ุงูุซูุงุซุงุก': '08 / 08', 'ุงูุฃุฑุจุนุงุก': '09 / 08', 'ุงูุฎููุณ': '10 / 08' } },
        's2_week3': { name: 'ุงูุฃุณุจูุน ุงูุซุงูุซ', semester: 2, startDate: '13 / 08', endDate: '17 / 08', days: { 'ุงูุฃุญุฏ': '13 / 08', 'ุงูุงุซููู': '14 / 08', 'ุงูุซูุงุซุงุก': '15 / 08', 'ุงูุฃุฑุจุนุงุก': '16 / 08', 'ุงูุฎููุณ': '17 / 08' } },
        's2_week4': { name: 'ุงูุฃุณุจูุน ุงูุฑุงุจุน', semester: 2, startDate: '20 / 08', endDate: '24 / 08', days: { 'ุงูุฃุญุฏ': '20 / 08', 'ุงูุงุซููู': '21 / 08', 'ุงูุซูุงุซุงุก': '22 / 08', 'ุงูุฃุฑุจุนุงุก': '23 / 08', 'ุงูุฎููุณ': '24 / 08' } },
        's2_week5': { name: 'ุงูุฃุณุจูุน ุงูุฎุงูุณ', semester: 2, startDate: '27 / 08', endDate: '02 / 09', days: { 'ุงูุฃุญุฏ': '27 / 08', 'ุงูุงุซููู': '28 / 08', 'ุงูุซูุงุซุงุก': '29 / 08', 'ุงูุฃุฑุจุนุงุก': '01 / 09', 'ุงูุฎููุณ': '02 / 09' }, specialDays: { '01 / 09': { name: 'ุบุฑุฉ ุฑูุถุงู', type: 'occasion', color: 'green' } } },
        's2_week6': { name: 'ุงูุฃุณุจูุน ุงูุณุงุฏุณ', semester: 2, startDate: '05 / 09', endDate: '09 / 09', days: { 'ุงูุฃุญุฏ': '05 / 09', 'ุงูุงุซููู': '06 / 09', 'ุงูุซูุงุซุงุก': '07 / 09', 'ุงูุฃุฑุจุนุงุก': '08 / 09', 'ุงูุฎููุณ': '09 / 09' }, specialDays: { '05 / 09': { name: 'ุฅุฌุงุฒุฉ ููู ุงูุชุฃุณูุณ', type: 'holiday', color: 'green' } } },
        's2_week7': { name: 'ุงูุฃุณุจูุน ุงูุณุงุจุน', semester: 2, startDate: '12 / 09', endDate: '16 / 09', days: { 'ุงูุฃุญุฏ': '12 / 09', 'ุงูุงุซููู': '13 / 09', 'ุงูุซูุงุซุงุก': '14 / 09', 'ุงูุฃุฑุจุนุงุก': '15 / 09', 'ุงูุฎููุณ': '16 / 09' } },
        's2_eid_fitr': { name: 'ุฅุฌุงุฒุฉ ุนูุฏ ุงููุทุฑ', semester: 2, startDate: '16 / 09', endDate: '09 / 10', days: {}, holidayDetails: 'ุชุจุฏุฃ ุจููุงูุฉ ุฏูุงู ุงูุฎููุณ 09/16 ุฅูู ุงูุณุจุช 10/09' },
        's2_week8': { name: 'ุงูุฃุณุจูุน ุงูุซุงูู', semester: 2, startDate: '10 / 10', endDate: '14 / 10', days: { 'ุงูุฃุญุฏ': '10 / 10', 'ุงูุงุซููู': '11 / 10', 'ุงูุซูุงุซุงุก': '12 / 10', 'ุงูุฃุฑุจุนุงุก': '13 / 10', 'ุงูุฎููุณ': '14 / 10' } },
        's2_week9': { name: 'ุงูุฃุณุจูุน ุงูุชุงุณุน', semester: 2, startDate: '17 / 10', endDate: '21 / 10', days: { 'ุงูุฃุญุฏ': '17 / 10', 'ุงูุงุซููู': '18 / 10', 'ุงูุซูุงุซุงุก': '19 / 10', 'ุงูุฃุฑุจุนุงุก': '20 / 10', 'ุงูุฎููุณ': '21 / 10' }, specialDays: { '19 / 10': { name: 'ููู ุงูุตุญุฉ ุงูุนุงููู', type: 'occasion', color: 'blue' } } },
        's2_week10': { name: 'ุงูุฃุณุจูุน ุงูุนุงุดุฑ', semester: 2, startDate: '24 / 10', endDate: '28 / 10', days: { 'ุงูุฃุญุฏ': '24 / 10', 'ุงูุงุซููู': '25 / 10', 'ุงูุซูุงุซุงุก': '26 / 10', 'ุงูุฃุฑุจุนุงุก': '27 / 10', 'ุงูุฎููุณ': '28 / 10' } },
        's2_week11': { name: 'ุงูุฃุณุจูุน ุงูุญุงุฏู ุนุดุฑ', semester: 2, startDate: '02 / 11', endDate: '06 / 11', days: { 'ุงูุฃุญุฏ': '02 / 11', 'ุงูุงุซููู': '03 / 11', 'ุงูุซูุงุซุงุก': '04 / 11', 'ุงูุฃุฑุจุนุงุก': '05 / 11', 'ุงูุฎููุณ': '06 / 11' } },
        's2_week12': { name: 'ุงูุฃุณุจูุน ุงูุซุงูู ุนุดุฑ', semester: 2, startDate: '09 / 11', endDate: '13 / 11', days: { 'ุงูุฃุญุฏ': '09 / 11', 'ุงูุงุซููู': '10 / 11', 'ุงูุซูุงุซุงุก': '11 / 11', 'ุงูุฃุฑุจุนุงุก': '12 / 11', 'ุงูุฎููุณ': '13 / 11' } },
        's2_week13': { name: 'ุงูุฃุณุจูุน ุงูุซุงูุซ ุนุดุฑ', semester: 2, startDate: '16 / 11', endDate: '20 / 11', days: { 'ุงูุฃุญุฏ': '16 / 11', 'ุงูุงุซููู': '17 / 11', 'ุงูุซูุงุซุงุก': '18 / 11', 'ุงูุฃุฑุจุนุงุก': '19 / 11', 'ุงูุฎููุณ': '20 / 11' } },
        's2_week14': { name: 'ุงูุฃุณุจูุน ุงูุฑุงุจุน ุนุดุฑ', semester: 2, startDate: '23 / 11', endDate: '27 / 11', days: { 'ุงูุฃุญุฏ': '23 / 11', 'ุงูุงุซููู': '24 / 11', 'ุงูุซูุงุซุงุก': '25 / 11', 'ุงูุฃุฑุจุนุงุก': '26 / 11', 'ุงูุฎููุณ': '27 / 11' } },
        's2_week15': { name: 'ุงูุฃุณุจูุน ุงูุฎุงูุณ ุนุดุฑ', semester: 2, startDate: '30 / 11', endDate: '04 / 12', days: { 'ุงูุฃุญุฏ': '30 / 11', 'ุงูุงุซููู': '01 / 12', 'ุงูุซูุงุซุงุก': '02 / 12', 'ุงูุฃุฑุจุนุงุก': '03 / 12', 'ุงูุฎููุณ': '04 / 12' } },
        's2_eid_adha': { name: 'ุฅุฌุงุฒุฉ ุนูุฏ ุงูุฃุถุญู', semester: 2, startDate: '04 / 12', endDate: '15 / 12', days: {}, holidayDetails: 'ุชุจุฏุฃ ุจููุงูุฉ ุฏูุงู ุงูุฎููุณ 12/04 ุฅูู ุงูุงุซููู 12/15' },
        's2_week16': { name: 'ุงูุฃุณุจูุน ุงูุณุงุฏุณ ุนุดุฑ', semester: 2, startDate: '16 / 12', endDate: '18 / 12', days: { 'ุงูุซูุงุซุงุก': '16 / 12', 'ุงูุฃุฑุจุนุงุก': '17 / 12', 'ุงูุฎููุณ': '18 / 12' } },
        's2_week17': { name: 'ุงูุฃุณุจูุน ุงูุณุงุจุน ุนุดุฑ', semester: 2, startDate: '21 / 12', endDate: '25 / 12', days: { 'ุงูุฃุญุฏ': '21 / 12', 'ุงูุงุซููู': '22 / 12', 'ุงูุซูุงุซุงุก': '23 / 12', 'ุงูุฃุฑุจุนุงุก': '24 / 12', 'ุงูุฎููุณ': '25 / 12' } },
        's2_week18': { name: 'ุงูุฃุณุจูุน ุงูุซุงูู ุนุดุฑ', semester: 2, startDate: '28 / 12', endDate: '03 / 01', days: { 'ุงูุฃุญุฏ': '28 / 12', 'ุงูุงุซููู': '29 / 12', 'ุงูุซูุงุซุงุก': '01 / 01', 'ุงูุฃุฑุจุนุงุก': '02 / 01', 'ุงูุฎููุณ': '03 / 01' }, specialDays: { '01 / 01': { name: 'ุณูุฉ ูุฌุฑูุฉ 1448', type: 'occasion', color: 'green' } } },
        's2_week19': { name: 'ุงูุฃุณุจูุน ุงูุชุงุณุน ุนุดุฑ', semester: 2, startDate: '06 / 01', endDate: '10 / 01', days: { 'ุงูุฃุญุฏ': '06 / 01', 'ุงูุงุซููู': '07 / 01', 'ุงูุซูุงุซุงุก': '08 / 01', 'ุงูุฃุฑุจุนุงุก': '09 / 01', 'ุงูุฎููุณ': '10 / 01' } }
    };
    const weeksS2_Western = {
        's2_week1': { name: 'ุงูุฃุณุจูุน ุงูุฃูู', semester: 2, startDate: '29 / 07', endDate: '03 / 08', days: { 'ุงูุฃุญุฏ': '29 / 07', 'ุงูุงุซููู': '30 / 07', 'ุงูุซูุงุซุงุก': '01 / 08', 'ุงูุฃุฑุจุนุงุก': '02 / 08', 'ุงูุฎููุณ': '03 / 08' } },
        's2_week2': { name: 'ุงูุฃุณุจูุน ุงูุซุงูู', semester: 2, startDate: '06 / 08', endDate: '10 / 08', days: { 'ุงูุฃุญุฏ': '06 / 08', 'ุงูุงุซููู': '07 / 08', 'ุงูุซูุงุซุงุก': '08 / 08', 'ุงูุฃุฑุจุนุงุก': '09 / 08', 'ุงูุฎููุณ': '10 / 08' } },
        's2_week3': { name: 'ุงูุฃุณุจูุน ุงูุซุงูุซ', semester: 2, startDate: '13 / 08', endDate: '17 / 08', days: { 'ุงูุฃุญุฏ': '13 / 08', 'ุงูุงุซููู': '14 / 08', 'ุงูุซูุงุซุงุก': '15 / 08', 'ุงูุฃุฑุจุนุงุก': '16 / 08', 'ุงูุฎููุณ': '17 / 08' } },
        's2_week4': { name: 'ุงูุฃุณุจูุน ุงูุฑุงุจุน', semester: 2, startDate: '20 / 08', endDate: '24 / 08', days: { 'ุงูุฃุญุฏ': '20 / 08', 'ุงูุงุซููู': '21 / 08', 'ุงูุซูุงุซุงุก': '22 / 08', 'ุงูุฃุฑุจุนุงุก': '23 / 08', 'ุงูุฎููุณ': '24 / 08' } },
        's2_week5': { name: 'ุงูุฃุณุจูุน ุงูุฎุงูุณ', semester: 2, startDate: '27 / 08', endDate: '02 / 09', days: { 'ุงูุฃุญุฏ': '27 / 08', 'ุงูุงุซููู': '28 / 08', 'ุงูุซูุงุซุงุก': '29 / 08', 'ุงูุฃุฑุจุนุงุก': '01 / 09', 'ุงูุฎููุณ': '02 / 09' }, specialDays: { '01 / 09': { name: 'ุบุฑุฉ ุฑูุถุงู', type: 'occasion', color: 'green' } } },
        's2_week6': { name: 'ุงูุฃุณุจูุน ุงูุณุงุฏุณ', semester: 2, startDate: '05 / 09', endDate: '09 / 09', days: { 'ุงูุฃุญุฏ': '05 / 09', 'ุงูุงุซููู': '06 / 09', 'ุงูุซูุงุซุงุก': '07 / 09', 'ุงูุฃุฑุจุนุงุก': '08 / 09', 'ุงูุฎููุณ': '09 / 09' }, specialDays: { '05 / 09': { name: 'ุฅุฌุงุฒุฉ ููู ุงูุชุฃุณูุณ', type: 'holiday', color: 'green' } } },
        's2_week7': { name: 'ุงูุฃุณุจูุน ุงูุณุงุจุน', semester: 2, startDate: '12 / 09', endDate: '16 / 09', days: { 'ุงูุฃุญุฏ': '12 / 09', 'ุงูุงุซููู': '13 / 09', 'ุงูุซูุงุซุงุก': '14 / 09', 'ุงูุฃุฑุจุนุงุก': '15 / 09', 'ุงูุฎููุณ': '16 / 09' } },
        's2_eid_fitr': { name: 'ุฅุฌุงุฒุฉ ุนูุฏ ุงููุทุฑ', semester: 2, startDate: '16 / 09', endDate: '09 / 10', days: {}, holidayDetails: 'ุชุจุฏุฃ ุจููุงูุฉ ุฏูุงู ุงูุฎููุณ 09/16 ุฅูู ุงูุณุจุช 10/09' },
        's2_week8': { name: 'ุงูุฃุณุจูุน ุงูุซุงูู', semester: 2, startDate: '10 / 10', endDate: '14 / 10', days: { 'ุงูุฃุญุฏ': '10 / 10', 'ุงูุงุซููู': '11 / 10', 'ุงูุซูุงุซุงุก': '12 / 10', 'ุงูุฃุฑุจุนุงุก': '13 / 10', 'ุงูุฎููุณ': '14 / 10' } },
        's2_week9': { name: 'ุงูุฃุณุจูุน ุงูุชุงุณุน', semester: 2, startDate: '17 / 10', endDate: '21 / 10', days: { 'ุงูุฃุญุฏ': '17 / 10', 'ุงูุงุซููู': '18 / 10', 'ุงูุซูุงุซุงุก': '19 / 10', 'ุงูุฃุฑุจุนุงุก': '20 / 10', 'ุงูุฎููุณ': '21 / 10' }, specialDays: { '19 / 10': { name: 'ููู ุงูุตุญุฉ ุงูุนุงููู', type: 'occasion', color: 'blue' } } },
        's2_week10': { name: 'ุงูุฃุณุจูุน ุงูุนุงุดุฑ', semester: 2, startDate: '24 / 10', endDate: '28 / 10', days: { 'ุงูุฃุญุฏ': '24 / 10', 'ุงูุงุซููู': '25 / 10', 'ุงูุซูุงุซุงุก': '26 / 10', 'ุงูุฃุฑุจุนุงุก': '27 / 10', 'ุงูุฎููุณ': '28 / 10' } },
        's2_week11': { name: 'ุงูุฃุณุจูุน ุงูุญุงุฏู ุนุดุฑ', semester: 2, startDate: '02 / 11', endDate: '06 / 11', days: { 'ุงูุฃุญุฏ': '02 / 11', 'ุงูุงุซููู': '03 / 11', 'ุงูุซูุงุซุงุก': '04 / 11', 'ุงูุฃุฑุจุนุงุก': '05 / 11', 'ุงูุฎููุณ': '06 / 11' } },
        's2_week12': { name: 'ุงูุฃุณุจูุน ุงูุซุงูู ุนุดุฑ', semester: 2, startDate: '09 / 11', endDate: '13 / 11', days: { 'ุงูุฃุญุฏ': '09 / 11', 'ุงูุงุซููู': '10 / 11', 'ุงูุซูุงุซุงุก': '11 / 11', 'ุงูุฃุฑุจุนุงุก': '12 / 11', 'ุงูุฎููุณ': '13 / 11' } },
        's2_week13': { name: 'ุงูุฃุณุจูุน ุงูุซุงูุซ ุนุดุฑ', semester: 2, startDate: '16 / 11', endDate: '20 / 11', days: { 'ุงูุฃุญุฏ': '16 / 11', 'ุงูุงุซููู': '17 / 11', 'ุงูุซูุงุซุงุก': '18 / 11', 'ุงูุฃุฑุจุนุงุก': '19 / 11', 'ุงูุฎููุณ': '20 / 11' } },
        's2_week14': { name: 'ุงูุฃุณุจูุน ุงูุฑุงุจุน ุนุดุฑ', semester: 2, startDate: '23 / 11', endDate: '27 / 11', days: { 'ุงูุฃุญุฏ': '23 / 11', 'ุงูุงุซููู': '24 / 11', 'ุงูุซูุงุซุงุก': '25 / 11', 'ุงูุฃุฑุจุนุงุก': '26 / 11', 'ุงูุฎููุณ': '27 / 11' } },
        's2_eid_adha': { name: 'ุฅุฌุงุฒุฉ ุนูุฏ ุงูุฃุถุญู', semester: 2, startDate: '27 / 11', endDate: '15 / 12', days: {}, holidayDetails: 'ุชุจุฏุฃ ุจููุงูุฉ ุฏูุงู ุงูุฎููุณ 11/27 ุฅูู ุงูุงุซููู 12/15' },
        's2_week15': { name: 'ุงูุฃุณุจูุน ุงูุฎุงูุณ ุนุดุฑ', semester: 2, startDate: '16 / 12', endDate: '18 / 12', days: { 'ุงูุซูุงุซุงุก': '16 / 12', 'ุงูุฃุฑุจุนุงุก': '17 / 12', 'ุงูุฎููุณ': '18 / 12' } },
        's2_week16': { name: 'ุงูุฃุณุจูุน ุงูุณุงุฏุณ ุนุดุฑ', semester: 2, startDate: '21 / 12', endDate: '25 / 12', days: { 'ุงูุฃุญุฏ': '21 / 12', 'ุงูุงุซููู': '22 / 12', 'ุงูุซูุงุซุงุก': '23 / 12', 'ุงูุฃุฑุจุนุงุก': '24 / 12', 'ุงูุฎููุณ': '25 / 12' } },
        's2_week17': { name: 'ุงูุฃุณุจูุน ุงูุณุงุจุน ุนุดุฑ', semester: 2, startDate: '28 / 12', endDate: '03 / 01', days: { 'ุงูุฃุญุฏ': '28 / 12', 'ุงูุงุซููู': '29 / 12', 'ุงูุซูุงุซุงุก': '01 / 01', 'ุงูุฃุฑุจุนุงุก': '02 / 01', 'ุงูุฎููุณ': '03 / 01' }, specialDays: { '01 / 01': { name: 'ุณูุฉ ูุฌุฑูุฉ 1448', type: 'occasion', color: 'green' } } },
        's2_week18': { name: 'ุงูุฃุณุจูุน ุงูุซุงูู ุนุดุฑ', semester: 2, startDate: '06 / 01', endDate: '10 / 01', days: { 'ุงูุฃุญุฏ': '06 / 01', 'ุงูุงุซููู': '07 / 01', 'ุงูุซูุงุซุงุก': '08 / 01', 'ุงูุฃุฑุจุนุงุก': '09 / 01', 'ุงูุฎููุณ': '10 / 01' } },
        's2_week19': { name: 'ุงูุฃุณุจูุน ุงูุชุงุณุน ุนุดุฑ', semester: 2, startDate: '13 / 01', endDate: '17 / 01', days: { 'ุงูุฃุญุฏ': '13 / 01', 'ุงูุงุซููู': '14 / 01', 'ุงูุซูุงุซุงุก': '15 / 01', 'ุงูุฃุฑุจุนุงุก': '16 / 01', 'ุงูุฎููุณ': '17 / 01' } }
    };
    function getAcademicWeeks(region) {
        let semester1, semester2;
        if (region === 'western') {
            semester1 = weeksS1_Western;
            semester2 = weeksS2_Western;
        } else {
            semester1 = weeksS1_Other;
            semester2 = weeksS2_Other;
        }
        return { ...semester1, ...semester2 };
    }
    
    let activeWeeksData = getAcademicWeeks('other');
    let tempSelectedDates = [];
    let state = {};

    // --- DOM Elements ---
    const tabButtons = document.querySelectorAll('.tab-button');
    const contentSections = document.querySelectorAll('.content-section');
    const stageSelectPlan = document.getElementById('stage-select-plan');
    const programSelectPlan = document.getElementById('program-select-plan');
    const objectiveSelect = document.getElementById('objective-select');
    const datePickerBtn = document.getElementById('date-picker-btn');
    const stageSelectReports = document.getElementById('stage-select-reports');
    const programSelectReports = document.getElementById('program-select-reports');
    const generateReportBtn = document.getElementById('generate-report-btn');
    const fontSelect = document.getElementById('font-select');

    // --- Event Listeners ---
    tabButtons.forEach(button => {
        button.addEventListener('click', () => {
            tabButtons.forEach(btn => btn.classList.remove('active'));
            contentSections.forEach(sec => sec.classList.remove('active'));
            button.classList.add('active');
            document.getElementById(button.id.replace('tab-btn-', 'content-')).classList.add('active');
        });
    });

    function populateStages(selectElement) {
        const stages = { 'primary': 'ุงูุงุจุชุฏุงุฆูุฉ (ุงูุฃูููุฉ)', 'upper-primary': 'ุงูุงุจุชุฏุงุฆูุฉ (ุงูุนููุง)', 'middle': 'ุงููุชูุณุทุฉ', 'high-2': 'ุงูุซุงูููุฉ' };
        selectElement.innerHTML = '<option value="">-- ุงุฎุชุฑ ุงููุฑุญูุฉ ุงูุฏุฑุงุณูุฉ --</option>';
        for (const key in stages) {
            selectElement.innerHTML += `<option value="${key}">${stages[key]}</option>`;
        }
    }

    function populateProgramsByStage(stage, programSelectElement, useGenericName = false) {
        programSelectElement.innerHTML = '<option value="">-- ุงุฎุชุฑ ุงูุจุฑูุงูุฌ --</option>';
        programSelectElement.disabled = true;
        if (!stage) return;
        
        Object.entries(fieldsData).forEach(([progKey, progData]) => {
            if (progData.stages && progData.stages[stage]) {
                const option = document.createElement('option');
                option.value = `${progKey}|${stage}`;
                option.textContent = useGenericName ? progData.name : (progData.stages[stage].name || progData.name);
                programSelectElement.appendChild(option);
            }
        });
        programSelectElement.disabled = false;
    }

    // --- Setup Functions ---
    function setupPlanTab() {
        populateStages(stageSelectPlan);
        
        stageSelectPlan.addEventListener('change', () => {
            const stage = stageSelectPlan.value;
            programSelectPlan.innerHTML = '<option value="">-- ุงุฎุชุฑ ุงูุจุฑูุงูุฌ --</option>';
            programSelectPlan.disabled = true;
            objectiveSelect.innerHTML = '<option value="">-- ุงุฎุชุฑ ุงููุฏู --</option>';
            objectiveSelect.disabled = true;

            if (!stage) return;

            const cultureField = "ุงูุซูุงูุฉ ูุงููููู";
            Object.entries(fieldsData).forEach(([key, program]) => {
                if (program.field === cultureField && program.stages[stage]) {
                    const option = document.createElement('option');
                    option.value = key;
                    option.textContent = program.name;
                    programSelectPlan.appendChild(option);
                }
            });
            programSelectPlan.disabled = false;

            const objectives = { 
                'ุชุนุฒูุฒ ุงููุฏุฑุณุฉ ููุดุฑุงูุฉ ุงููุฌุชูุนูุฉ': 'ูก- ุชุนุฒูุฒ ุงููุฏุฑุณุฉ ููุดุฑุงูุฉ ุงููุฌุชูุนูุฉ',
                'ุฏุนู ุงูุฃูุดุทุฉ ุงูุทูุงุจูุฉ ููุณููู ุงูุฅูุฌุงุจู': 'ูข- ุฏุนู ุงูุฃูุดุทุฉ ุงูุทูุงุจูุฉ ููุณููู ุงูุฅูุฌุงุจู',
                'ุชุนุฒูุฒ ูุดุงุฑูุฉ ุฃูููุงุก ุงูุฃููุฑ ูู ุงูุฃูุดุทุฉ ุงูุทูุงุจูุฉ': 'ูฃ- ุชุนุฒูุฒ ูุดุงุฑูุฉ ุฃูููุงุก ุงูุฃููุฑ ูู ุงูุฃูุดุทุฉ ุงูุทูุงุจูุฉ',
                'ุฒูุงุฏุฉ ุฌุงุฐุจูุฉ ุงูุจูุฆุฉ ุงููุฏุฑุณูุฉ ุฑุถู ุงูุทุงูุจ ุนู ุงูุญูุงุฉ': 'ูค- ุฒูุงุฏุฉ ุฌุงุฐุจูุฉ ุงูุจูุฆุฉ ุงููุฏุฑุณูุฉ ุฑุถู ุงูุทุงูุจ ุนู ุงูุญูุงุฉ',
                'ุชุนุฒูุฒ ุงูุฃูุดุทุฉ ุงูุทูุงุจูุฉ ููุงูุถุจุงุท ุงููุฏุฑุณู': 'ูฅ- ุชุนุฒูุฒ ุงูุฃูุดุทุฉ ุงูุทูุงุจูุฉ ููุงูุถุจุงุท ุงููุฏุฑุณู',
                'ุฃูุดุทุฉ ุชุนูู ุชุทุจูููุฉ ุชุฑุชุจุท ุจุญูุงุฉ ุงููุชุนูููู': 'ูฆ- ุฃูุดุทุฉ ุชุนูู ุชุทุจูููุฉ ุชุฑุชุจุท ุจุญูุงุฉ ุงููุชุนูููู',
                'ุชุญุณูู ุงูุฃูุดุทุฉ ุงูุทูุงุจูุฉ ูููุงุชุฌ ุงูุชุนูู': 'ูง- ุชุญุณูู ุงูุฃูุดุทุฉ ุงูุทูุงุจูุฉ ูููุงุชุฌ ุงูุชุนูู',
                'ุงุนุชุฒุงุฒ ุงูุทูุจุฉ ุจุซูุงูุชูู ูุงุญุชุฑุงููู ููุชููุน ุงูุซูุงูู': 'ูจ- ุงุนุชุฒุงุฒ ุงูุทูุจุฉ ุจุซูุงูุชูู ูุงุญุชุฑุงููู ููุชููุน ุงูุซูุงูู',
                'ุชูุนูู ุงูููุงุณุจุงุช ุงููุทููุฉ ูุงูุฃุณุงุจูุน ูุงูุฃูุงู ุงูุนุงูููุฉ': 'ูฉ- ุชูุนูู ุงูููุงุณุจุงุช ุงููุทููุฉ ูุงูุฃุณุงุจูุน ูุงูุฃูุงู ุงูุนุงูููุฉ'
            };
            for (const [value, text] of Object.entries(objectives)) {
                const opt = document.createElement('option');
                opt.value = value;
                opt.textContent = text;
                objectiveSelect.appendChild(opt);
            }
        });

        programSelectPlan.addEventListener('change', () => {
            state.programKey = programSelectPlan.value;
            state.stage = stageSelectPlan.value;
            state.planDates = [];
            updateProgramDisplay();
        });
        
        ['btn-region-other', 'btn-region-western'].forEach(id => document.getElementById(id).addEventListener('click', (e) => { 
            const newRegion = id.includes('other') ? 'other' : 'western';
            if (state.region !== newRegion) {
                state.region = newRegion;
                updateRegionUI();
            }
        }));
        
        datePickerBtn.addEventListener('click', () => openDatePicker());
        document.getElementById('reset-plan-btn').addEventListener('click', () => { 
            if(confirm('ูู ุฃูุช ูุชุฃูุฏุ ุณูุชู ุญุฐู ุฌููุน ุงูุจูุงูุงุช ุงููุฏุฎูุฉ.')) { 
                localStorage.removeItem('planGeneratorState'); 
                location.reload(); 
            }
        });
        document.getElementById('generate-plan-btn').addEventListener('click', generatePlan);
    }

    function updateProgramDisplay() {
        if (!state.programKey || !state.stage) return;
        const programKeyOnly = state.programKey;
        const programData = fieldsData[programKeyOnly].stages[state.stage];
        if (!programData) return;
        document.getElementById('program-details-plan').innerHTML = `<p><strong class="font-semibold">ุงูุจุฑูุงูุฌ:</strong> ${programData.name}</p><p><strong class="font-semibold">ุนุฏุฏ ุงูุญุตุต ุงูููุชุฑุญ:</strong> ${programData.sessions} ุญุตุต</p>`;
        objectiveSelect.disabled = false;
        if (programData.duration.includes("ุงูุนุงู ุงูุฏุฑุงุณู") || programData.duration.includes("ูุฑูุฉ")) {
            datePickerBtn.disabled = true;
            datePickerBtn.textContent = 'ุงูุจุฑูุงูุฌ ูุณุชูุฑ ุฃู ุจูุฏุฉ ูุฑูุฉ';
            state.planDates = programData.details.map(d => d.date);
        } else {
            datePickerBtn.disabled = false;
            updateDatePickerButton();
        }
        ['strengths', 'difficulties', 'remedial_actions', 'achievements'].forEach(key => { 
            const elementId = key === 'achievements' ? 'additional-achievements' : key.replace('_', '-');
            const element = document.getElementById(elementId);
            if (element) element.value = programData[key] || ''; 
        });
    }

    function updateDatePickerButton() {
        if (!state.programKey || !state.stage) { datePickerBtn.textContent = 'ุงุฎุชุฑ ุชูุงุฑูุฎ ุงูุญุตุต'; return; }
        const programKeyOnly = state.programKey;
        const programData = fieldsData[programKeyOnly].stages[state.stage];
        if (!programData) return;
        const count = state.planDates ? state.planDates.filter(d => d !== 'ูุญุฏุฏ ูุงุญููุง' && d !== 'ูุงุญููุง').length : 0;
        datePickerBtn.textContent = `ุงุฎุชุฑ ุชูุงุฑูุฎ ุงูุญุตุต (${count} / ${programData.sessions})`;
    }

    function setupReportsTab() {
        populateStages(stageSelectReports);
        stageSelectReports.addEventListener('change', () => {
            populateProgramsByStage(stageSelectReports.value, programSelectReports, true);
            generateReportBtn.disabled = true;
            document.getElementById('report-dates-display').textContent = 'ุงุฎุชุฑ ูุฑุญูุฉ ูุจุฑูุงูุฌ ูุนุฑุถ ุงูุชูุงุฑูุฎ';
        });
        programSelectReports.addEventListener('change', () => {
            generateReportBtn.disabled = !programSelectReports.value;
            const datesDisplay = document.getElementById('report-dates-display');
            if (state.planDates && state.planDates.length > 0 && !state.planDates.includes('ูุญุฏุฏ ูุงุญููุง') && !state.planDates.includes('ูุงุญููุง')) {
                state.planDates.sort((a, b) => parseDateForSorting(a) - parseDateForSorting(b));
                const dateRange = `ุชูุงุฑูุฎ ุงูุฎุทุฉ ุงููุญุฏุฏุฉ: ูู ${formatFullDate(state.planDates[0])} ุฅูู ${formatFullDate(state.planDates[state.planDates.length - 1])}`;
                datesDisplay.textContent = dateRange;
                datesDisplay.classList.remove('text-red-500');
            } else {
                datesDisplay.textContent = 'ููุงุญุธุฉ: ูู ูุชู ุชุญุฏูุฏ ุชูุงุฑูุฎ ุชูููุฐ ูู ุชุจููุจ ุงูุฎุทุฉ ุฃู ุฃู ุงูุจุฑูุงูุฌ ูุณุชูุฑ. ุณูุธูุฑ ุงูุชุงุฑูุฎ ูุงุฑุบุงู ูู ุงูุชูุฑูุฑ.';
                datesDisplay.classList.add('text-red-500');
            }
        });
        generateReportBtn.addEventListener('click', generateReport);
    }
    
    function generateReport() {
        const [progKey, stageKey] = programSelectReports.value.split('|');
        const programData = fieldsData[progKey].stages[stageKey];
        const leaderName = document.getElementById('leader-name').value;
        const directorName = document.getElementById('director-name').value;
        const educationAdmin = document.getElementById('education-admin').value;
        const schoolName = document.getElementById('school-name').value;

        let dateRange = "ูู ูุชู ุชุญุฏูุฏ ุงูุชูุงุฑูุฎ ูู ุงูุฎุทุฉ";
        if (state.planDates && state.planDates.length > 0 && !state.planDates.includes('ูุญุฏุฏ ูุงุญููุง') && !state.planDates.includes('ูุงุญููุง')) {
             state.planDates.sort((a, b) => parseDateForSorting(a) - parseDateForSorting(b));
             dateRange = `ูู ${formatFullDate(state.planDates[0])} ุฅูู ${formatFullDate(state.planDates[state.planDates.length - 1])}`;
        } else if (programData.duration.includes("ุงูุนุงู ุงูุฏุฑุงุณู") || programData.duration.includes("ูุฑูุฉ")) {
            dateRange = "ุนูู ูุฏุงุฑ ุงูุนุงู ุงูุฏุฑุงุณู ุฃู ุจูุฏุฉ ูุฑูุฉ";
        }
        
        const locationLines = (programData.location.match(/\n/g) || []).length + 1;
        const summaryContent = programData.executionSummary || "ุณูุชู ุชุญุฏูุซ ุงููููุน ุจุนุฏ ุตุฏูุฑ ุงูุฃุฏูุฉ ุงูุฎุงุตุฉ ุจุงูุจุฑุงูุฌ ูู ุงููุฑูุฒ ุงููุทูู ููููุงูุฌ";

        const reportHTML = `
            <header class="mb-4">
                <div class="flex justify-between items-center pb-2">
                    <img src="https://upload.wikimedia.org/wikipedia/ar/thumb/1/17/Saudi_Ministry_of_Education_Logo_2025.png/400px-Saudi_Ministry_of_Education_Logo_2025.png" alt="ุดุนุงุฑ ูุฒุงุฑุฉ ุงูุชุนููู" class="h-20">
                    <div class="flex-1 mr-4 space-y-2 text-base text-right">
                        <p class="font-bold">${educationAdmin}</p>
                        <p class="font-bold">${schoolName}</p>
                    </div>
                </div>
                <div class="gradient-line mt-2"></div>
                <h2 class="text-2xl font-bold text-teal-800 text-center mt-4">ุชูุฑูุฑ ุชูููุฐ ุจุฑูุงูุฌ ูุดุงุท</h2>
            </header>
            <main>
                <h3 class="text-xl font-bold mb-3 text-teal-700 text-center">${programData.name}</h3>
                <table class="w-full mb-4 text-sm border-collapse table-bordered">
                    <tbody>
                        <tr><td class="font-bold bg-slate-50 w-1/5">ุงููุฑุญูุฉ:</td><td colspan="3"><textarea id="report-stage-report" class="w-full border-none p-2 resize-none" rows="1">${stageSelectReports.options[stageSelectReports.selectedIndex].text}</textarea></td></tr>
                        <tr><td class="font-bold bg-slate-50 w-1/5">ุงููุฏู ูู ุงูุจุฑูุงูุฌ:</td><td colspan="3"><textarea id="report-objective-report" class="w-full border-none p-2 resize-none" rows="1">${state.objective || 'ูู ูุญุฏุฏ ูู ุงูุฎุทุฉ'}</textarea></td></tr>
                        <tr><td class="font-bold bg-slate-50 w-1/5">ุชุงุฑูุฎ ุงูุชูููุฐ:</td><td><textarea id="report-date-report" class="w-full border-none p-2 resize-none" rows="1">${dateRange}</textarea></td><td class="font-bold bg-slate-50 w-1/5">ููุงู ุงูุชูููุฐ:</td><td><textarea id="report-location-report" rows="${locationLines}" oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"' class="w-full border-none p-1 bg-transparent" style="overflow-y:hidden; resize:none;">${programData.location}</textarea></td></tr>
                        <tr><td class="font-bold bg-slate-50 w-1/5">ุนุฏุฏ ุงูุทูุงุจ ุงููุณุชููุฏูู:</td><td><input type="text" class="w-full border-none p-1" placeholder="ููุชุนุจุฆุฉ"></td><td class="font-bold bg-slate-50 w-1/5">ุงููุนูู/ุฉ ุงููููุฐ/ุฉ:</td><td><input type="text" class="w-full border-none p-1" value="${document.getElementById('teacher-name').value}"></td></tr>
                        <tr>
                            <td class="report-label align-top">ููุงุชุฌ ุงูุชุนูู:</td>
                            <td class="p-0 border border-slate-200 whitespace-pre-line" colspan="3">
                                <textarea id="report-learning-outcomes-report" class="w-full border-none p-2 resize-none" rows="3">${programData.learningOutcomes}</textarea>
                            </td>
                        </tr>
                        <tr>
                            <td class="report-label align-top">ุฅุฌุฑุงุกุงุช ุงูุชูููุฐ (ููุฎุต):</td>
                            <td class="p-0 border border-slate-200 whitespace-pre-line" colspan="3">
                                <textarea id="report-details-report" class="w-full border-none p-2 resize-none" rows="3">${summaryContent}</textarea>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <div class="space-y-4 text-sm">
                    <div>
                        <h4 class="report-label mb-1 mt-8">ุตูุฑ ููุดูุงูุฏ</h4>
                        <div id="image-upload-grid" class="grid grid-cols-3 gap-4 mt-2">
                            ${Array(6).fill(0).map((_, i) => `
                                <div class="aspect-square border-2 border-dashed rounded-lg flex items-center justify-center text-slate-400 relative image-upload-slot">
                                    <label for="image-input-${i}" class="cursor-pointer absolute inset-0 flex flex-col items-center justify-center z-10">
                                        <svg class="w-8 h-8 mb-1" fill="none" stroke="currentColor" viewBox="0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg><span>ุฅุถุงูุฉ ุตูุฑุฉ ${i + 1}</span></label>
                                    <input type="file" id="image-input-${i}" class="hidden" accept="image/*" onchange="previewImage(event, 'image-preview-${i}')">
                                    <img id="image-preview-${i}" class="absolute inset-0 w-full h-full object-cover rounded-lg hidden z-0">
                                </div>`).join('')}
                        </div>
                    </div>
                </div>
            </main>
            <footer class="pt-8 text-center text-xs">
                <div class="gradient-line mb-4"></div>
                <div class="grid grid-cols-2 gap-16">
                    <div class="pt-2 mt-2"><p class="font-bold h-6">${leaderName}</p></div>
                    <div class="pt-2 mt-2"><p class="font-bold h-6">${directorName}</p></div>
                </div>
            </footer>`;
        document.getElementById('report-page-content').innerHTML = reportHTML;
        document.getElementById('setup-screen-reports').classList.add('hidden');
        document.getElementById('output-report').classList.remove('hidden');

        document.querySelectorAll('#report-page-content textarea').forEach(textarea => {
            autoGrowTextarea(textarea);
            textarea.addEventListener('input', () => autoGrowTextarea(textarea));
        });
    }
    
    const parseDateForSorting = (dateString) => { const parts = dateString.split(' '); return parseInt(parts[3], 10) * 100 + parseInt(parts[1], 10); };
    const formatFullDate = (dateString) => { const p = dateString.split(' '); return `${p[1].padStart(2, '0')} / ${p[3].padStart(2, '0')} / 1447 ูู`; };
    const saveState = () => { 
        state.objective = objectiveSelect.value; 
        localStorage.setItem('planGeneratorState', JSON.stringify(state)); 
    };
    
    function autoGrowTextarea(element) {
        if(!element) return;
        element.style.height = "auto";
        element.style.height = (element.scrollHeight) + "px";
    }

    window.previewImage = function(event, imgId) {
        const img = document.getElementById(imgId);
        const input = event.target;
        const slot = input.closest('.image-upload-slot');
        const label = slot.querySelector('label');
        if (input.files && input.files[0]) {
            img.src = URL.createObjectURL(input.files[0]);
            img.classList.remove('hidden');
            label.classList.add('opacity-0', 'hover:opacity-75', 'hover:bg-black/50');
            label.querySelector('span').textContent = 'ุชุบููุฑ ุงูุตูุฑุฉ';
            slot.classList.add('has-image');
        }
    }

    // ==========================================
    // ุฏุงูุฉ ูุชุญ ุงููุงูุฐุฉ ุงูููุจุซูุฉ (ูุญุฏุซุฉ ูุน ุชุจููุจุงุช ุงููุตูู)
    // ==========================================
    window.openDatePicker = function() {
        const modal = document.getElementById('date-picker-modal');
        const programKeyOnly = state.programKey;
        const programData = fieldsData[programKeyOnly]?.stages[state.stage];
        if (!programData) return;
        
        tempSelectedDates = [...(state.planDates || [])].filter(d => d !== 'ูุญุฏุฏ ูุงุญููุง' && d !== 'ูุงุญููุง');
        const container = document.getElementById('modal-weeks-container');
        container.innerHTML = '';
        
        document.getElementById('modal-title').textContent = `ุงุฎุชุฑ ${programData.sessions} ุญุตุต ูุจุฑูุงูุฌ: ${programData.name}`;
        
        // 1. ุฅูุดุงุก ุนูุงุตุฑ ุงูุชุจููุจ
        const tabsHeader = document.createElement('div');
        tabsHeader.className = "flex border-b border-gray-200 mb-4 sticky top-0 bg-white z-10 pt-2";
        
        const btnS1 = document.createElement('button');
        btnS1.className = "flex-1 py-3 text-center font-bold text-teal-700 border-b-4 border-teal-600 bg-teal-50 transition-all duration-200";
        btnS1.textContent = "ุงููุตู ุงูุฏุฑุงุณู ุงูุฃูู";
        
        const btnS2 = document.createElement('button');
        btnS2.className = "flex-1 py-3 text-center font-medium text-gray-500 hover:text-gray-700 hover:bg-gray-50 transition-all duration-200";
        btnS2.textContent = "ุงููุตู ุงูุฏุฑุงุณู ุงูุซุงูู";
        
        tabsHeader.appendChild(btnS1);
        tabsHeader.appendChild(btnS2);
        container.appendChild(tabsHeader);

        // 2. ุฅูุดุงุก ุญุงููุงุช ุงููุญุชูู ูููุตููู
        const divS1 = document.createElement('div');
        divS1.className = "space-y-4 pb-4";
        
        const divS2 = document.createElement('div');
        divS2.className = "space-y-4 pb-4 hidden"; // ูุฎูู ุงูุชุฑุงุถูุงู

        // 3. ููุทู ุงูุชุจุฏูู ุจูู ุงูุชุจููุจุงุช
        btnS1.onclick = () => {
            divS1.classList.remove('hidden');
            divS2.classList.add('hidden');
            btnS1.className = "flex-1 py-3 text-center font-bold text-teal-700 border-b-4 border-teal-600 bg-teal-50 transition-all duration-200";
            btnS2.className = "flex-1 py-3 text-center font-medium text-gray-500 hover:text-gray-700 hover:bg-gray-50 transition-all duration-200";
        };
        
        btnS2.onclick = () => {
            divS1.classList.add('hidden');
            divS2.classList.remove('hidden');
            btnS1.className = "flex-1 py-3 text-center font-medium text-gray-500 hover:text-gray-700 hover:bg-gray-50 transition-all duration-200";
            btnS2.className = "flex-1 py-3 text-center font-bold text-teal-700 border-b-4 border-teal-600 bg-teal-50 transition-all duration-200";
        };

        // 4. ุฏุงูุฉ ูุณุงุนุฏุฉ ูุฅูุดุงุก ุนูุตุฑ ุงูุฃุณุจูุน
        const createWeekElement = (weekData) => {
            const weekDiv = document.createElement('div');
            weekDiv.className = 'p-3 border rounded-lg bg-white shadow-sm hover:shadow-md transition-shadow';
            weekDiv.innerHTML = `<p class="font-bold text-center mb-3 text-teal-800 border-b pb-2">${weekData.name}</p>`;
            
            const weekGrid = document.createElement('div');
            weekGrid.className = 'week-grid grid grid-cols-5 gap-2';
            
            if (!weekData.days || Object.keys(weekData.days).length === 0) {
                const noteDiv = document.createElement('div');
                noteDiv.className = 'holiday-note col-span-5 text-center p-2 bg-red-50 text-red-700 rounded text-sm';
                noteDiv.textContent = weekData.holidayDetails || 'ุฅุฌุงุฒุฉ ุฑุณููุฉ';
                weekGrid.appendChild(noteDiv);
            } else {
                Object.entries(weekData.days).forEach(([dayName, dayDate]) => {
                    const dayButton = document.createElement('button');
                    dayButton.className = 'day p-2 border rounded-md text-sm w-full transition-colors hover:bg-slate-50 relative';
                    const fullDate = `${dayName} ${dayDate}`;
                    dayButton.dataset.date = fullDate;
                    
                    let buttonText = `<span class="block font-bold">${dayName}</span><span class="block text-gray-600">${dayDate}</span>`;
                    
                    if (weekData.specialDays && weekData.specialDays[dayDate]) {
                        const sp = weekData.specialDays[dayDate];
                        const colorClass = sp.color === 'green' ? 'text-green-600' : (sp.color === 'red' ? 'text-red-600' : 'text-blue-600');
                        buttonText += `<span class="block text-xs mt-1 ${colorClass}">${sp.name}</span>`;

                        if (sp.type === 'holiday') {
                            // ุฅุฐุง ูุงูุช ุฅุฌุงุฒุฉ ุฑุณููุฉ -> ุชุนุทูู
                            dayButton.classList.add('disabled', 'opacity-60', 'bg-slate-100', 'cursor-not-allowed');
                            dayButton.disabled = true;
                        } else {
                            // ุฅุฐุง ูุงูุช ููุงุณุจุฉ (ูุซู ุฑูุถุงู) -> ุชูุนูู ูุน ุชูููุฒ ูููู
                            dayButton.classList.add('bg-yellow-50', 'border-yellow-200');
                            dayButton.onclick = () => toggleDateSelection(dayButton);
                        }
                    } else {
                        // ููู ุนุงุฏู
                        dayButton.onclick = () => toggleDateSelection(dayButton);
                    }
                    
                    if (tempSelectedDates.includes(fullDate)) {
                        dayButton.classList.add('selected', 'bg-teal-600', 'text-white', 'border-teal-700');
                        dayButton.classList.remove('bg-yellow-50'); // ุฅุฒุงูุฉ ููู ุงูููุงุณุจุฉ ุนูุฏ ุงูุชุญุฏูุฏ
                        // ุฅุฒุงูุฉ ุชุฃุซูุฑุงุช ุงููุต ุงูุฑูุงุฏู ุนูุฏ ุงูุชุญุฏูุฏ
                        buttonText = buttonText.replace('text-gray-600', 'text-teal-100'); 
                    }
                    
                    dayButton.innerHTML = buttonText;
                    weekGrid.appendChild(dayButton);
                });
            }
            weekDiv.appendChild(weekGrid);
            return weekDiv;
        };

        // 5. ุชูุฒูุน ุงูุจูุงูุงุช ุนูู ุงูุญุงููุงุช
        Object.values(activeWeeksData).forEach(weekData => {
            const weekElement = createWeekElement(weekData);
            if (weekData.semester === 1) {
                divS1.appendChild(weekElement);
            } else if (weekData.semester === 2) {
                divS2.appendChild(weekElement);
            }
        });

        container.appendChild(divS1);
        container.appendChild(divS2);
        
        modal.style.display = 'flex';
    }

    window.toggleDateSelection = function(button) {
        const date = button.dataset.date;
        const isSelected = button.classList.contains('selected');
        const programKeyOnly = state.programKey;
        const sessions = fieldsData[programKeyOnly].stages[state.stage].sessions;
        
        if (isSelected) {
            tempSelectedDates = tempSelectedDates.filter(d => d !== date);
            button.classList.remove('selected', 'bg-teal-600', 'text-white', 'border-teal-700');
            
            // ุฅุฐุง ูุงู ูููุงู ูููุฒุงู (ููุงุณุจุฉ)ุ ุฃุนุฏ ููู ุงูุฎูููุฉ ุงูุฃุตูุฑ
            if (button.classList.contains('border-yellow-200')) {
                button.classList.add('bg-yellow-50');
            }

            // ุงุณุชุนุงุฏุฉ ููุท ุงููุต ุงูุฃุตูู
            const dateSpan = button.querySelector('span:nth-child(2)');
            if(dateSpan) dateSpan.classList.replace('text-teal-100', 'text-gray-600');
        } else {
            if (tempSelectedDates.length < sessions) {
                tempSelectedDates.push(date);
                button.classList.add('selected', 'bg-teal-600', 'text-white', 'border-teal-700');
                button.classList.remove('bg-yellow-50'); // ุฅุฒุงูุฉ ุงูุชูููุฒ ุนูุฏ ุงูุชุญุฏูุฏ ูุชูุญูุฏ ุงูุดูู
                
                // ุชุบููุฑ ููู ุงูุชุงุฑูุฎ ููููู ููุฑูุกุงู ุนูู ุงูุฎูููุฉ ุงูุฏุงููุฉ
                const dateSpan = button.querySelector('span:nth-child(2)');
                if(dateSpan) dateSpan.classList.replace('text-gray-600', 'text-teal-100');
            } else {
                alert(`ูุง ูููู ุงุฎุชูุงุฑ ุฃูุซุฑ ูู ${sessions} ุญุตุต.`);
            }
        }
    }

    window.closeDatePicker = function() { document.getElementById('date-picker-modal').style.display = 'none'; tempSelectedDates = []; }
    window.saveDates = function() { state.planDates = [...(tempSelectedDates || [])]; updateDatePickerButton(); saveState(); closeDatePicker(); }

    function generatePlan() {
        state = { ...state, objective: objectiveSelect.value, ...Object.fromEntries(['teacher-name', 'leader-name', 'director-name', 'education-admin', 'school-name', 'strengths', 'difficulties', 'remedial-actions'].map(id => [id.replace(/-(\w)/g, (m, p1) => p1.toUpperCase()), document.getElementById(id).value])), achievements: document.getElementById('additional-achievements').value };
        const programKeyOnly = state.programKey;
        const programData = fieldsData[programKeyOnly]?.stages[state.stage];
        if (!programData || !state.objective) { alert('ูุฑุฌู ุงูุชุฃูุฏ ูู ุงุฎุชูุงุฑ ุฌููุน ุงูุญููู ุงููุทููุจุฉ.'); return; }
        if (!programData.duration.includes("ุงูุนุงู ุงูุฏุฑุงุณู") && !programData.duration.includes("ูุฑูุฉ") && (!state.planDates || state.planDates.length === 0)) {
             alert(`ูุฑุฌู ุงุฎุชูุงุฑ ุญุตุฉ ูุงุญุฏุฉ ุนูู ุงูุฃูู ูุชูููุฏ ุงูุฎุทุฉ.`); return; 
        }
        saveState(); 
        if(state.planDates && !state.planDates.includes('ูุญุฏุฏ ูุงุญููุง') && !state.planDates.includes('ูุงุญููุง')) {
            state.planDates.sort((a, b) => parseDateForSorting(a) - parseDateForSorting(b));
        }
        
        document.getElementById('report-education-admin-plan').textContent = state.educationAdmin;
        document.getElementById('report-school-name-plan').textContent = state.schoolName;
        document.getElementById('report-program-name-plan').value = fieldsData[programKeyOnly].name;
        document.getElementById('report-program-details-name-plan').value = programData.name;
        document.getElementById('report-objective-plan').value = state.objective;
        document.getElementById('report-program-target-plan').value = programData.target;
        document.getElementById('report-teacher-name-plan').value = state.teacherName;
        document.getElementById('report-duration-plan').value = programData.duration;
        document.getElementById('report-location-plan').value = programData.location;
        document.getElementById('report-tools-plan').value = programData.tools;
        document.getElementById('report-learning-outcomes-plan').value = programData.learningOutcomes;
        document.getElementById('report-assessment-methods-plan').value = programData.assessmentMethods;
        document.getElementById('report-leader-name-plan').textContent = state.leaderName;
        document.getElementById('report-director-name-plan').textContent = state.directorName;
        document.getElementById('report-additional-achievements-plan').value = state.achievements;
        document.getElementById('report-strengths-plan').value = state.strengths;
        document.getElementById('report-difficulties-plan').value = state.difficulties;
        document.getElementById('report-remedial-actions-plan').value = state.remedialActions;

        const tableBody = document.getElementById('plan-table-body');
        tableBody.innerHTML = '';

        programData.details.forEach((session, index) => {
            let date = (state.planDates && state.planDates[index]) ? state.planDates[index] : 'ูุงุญููุง';
            let weekName = session.week || '';
            
            if (date !== 'ูุญุฏุฏ ูุงุญููุง' && date !== 'ูุงุญููุง') {
                 for (const key in activeWeeksData) { 
                     if (activeWeeksData[key].days && Object.values(activeWeeksData[key].days).includes(date.split(' ').slice(1).join(' '))) { 
                        weekName = activeWeeksData[key].name; 
                        break; 
                    }
                }
            }

            tableBody.innerHTML += `<tr>
                <td><textarea class="w-full h-auto p-1 border-none resize-none" oninput="autoGrowTextarea(this)">${weekName}</textarea></td>
                <td><textarea class="w-full h-auto p-1 border-none resize-none" oninput="autoGrowTextarea(this)">${(date === 'ูุญุฏุฏ ูุงุญููุง' || date === 'ูุงุญููุง') ? 'ูุญุฏุฏ ูุงุญููุง' : formatFullDate(date)}</textarea></td>
                <td><textarea class="w-full h-auto p-1 border-none resize-none" oninput="autoGrowTextarea(this)">${session.title}</textarea></td>
                <td><textarea class="w-full h-auto p-1 border-none resize-none" oninput="autoGrowTextarea(this)">${session.content}</textarea></td>
                <td class="text-xs">
                    <div class="flex items-center p-1"><span class="inline-block w-4 h-4 border border-slate-400 mr-2 ml-1"></span> ููุฐ</div>
                    <div class="flex items-center p-1 mt-1"><span class="inline-block w-4 h-4 border border-slate-400 mr-2 ml-1"></span> ูู ูููุฐ</div>
                </td>
            </tr>`;
        });

        document.getElementById('setup-screen-plan').classList.add('hidden');
        document.getElementById('output-plan').classList.remove('hidden');

        document.querySelectorAll('#output-plan textarea').forEach(textarea => autoGrowTextarea(textarea));
    }
    
    function prepareForPrinting(containerId) {
        const container = document.getElementById(containerId);
        if (!container) return;
        container.querySelectorAll('textarea, input[type="text"]').forEach(element => {
            let printDiv = element.nextElementSibling;
            if (!printDiv || !printDiv.classList.contains('print-only-content')) {
                printDiv = document.createElement('div');
                printDiv.className = 'print-only-content';
                element.parentNode.insertBefore(printDiv, element.nextSibling);
            }
            printDiv.innerHTML = element.value.replace(/\n/g, '<br>') || '&nbsp;';
        });
    }

    function cleanupAfterPrinting(containerId) {
        // This function is not needed with the new robust approach
    }

    window.printContent = function(elementId) {
        document.querySelectorAll('.content-section').forEach(el => el.classList.remove('printable-active'));
        const elementToPrint = document.getElementById(elementId);
        if (elementToPrint && elementToPrint.parentElement.classList.contains('content-section')) {
             elementToPrint.parentElement.classList.add('printable-active');
        }
        
        prepareForPrinting('output-plan');
        prepareForPrinting('output-report');
        
        setTimeout(() => {
            window.print();
        }, 100);
    }

    let afterPrintHandler = () => {
        // No cleanup needed
    };

    window.addEventListener('afterprint', afterPrintHandler);
    if (window.matchMedia) {
        let mediaQueryList = window.matchMedia('print');
        mediaQueryList.addEventListener('change', (mql) => {
            if (!mql.matches) {
                afterPrintHandler();
            }
        });
    }

    function updateRegionUI() {
        const btnOther = document.getElementById('btn-region-other');
        const btnWestern = document.getElementById('btn-region-western');
        if (state.region === 'western') {
            activeWeeksData = getAcademicWeeks('western');
            btnWestern.classList.add('bg-teal-600', 'text-white');
            btnOther.classList.remove('bg-teal-600', 'text-white');
        } else {
            activeWeeksData = getAcademicWeeks('other');
            btnOther.classList.add('bg-teal-600', 'text-white');
            btnWestern.classList.remove('bg-teal-600', 'text-white');
        }
    }
    
    function initializeApp() {
        state = JSON.parse(localStorage.getItem('planGeneratorState')) || { region: 'other' };
        if (state.educationAdmin) document.getElementById('education-admin').value = state.educationAdmin;
        if (state.schoolName) document.getElementById('school-name').value = state.schoolName;
        if (state.teacherName) document.getElementById('teacher-name').value = state.teacherName;
        if (state.leaderName) document.getElementById('leader-name').value = state.leaderName;
        if (state.directorName) document.getElementById('director-name').value = state.directorName;
        if (state.achievements) document.getElementById('additional-achievements').value = state.achievements;
        if (state.strengths) document.getElementById('strengths').value = state.strengths;
        if (state.difficulties) document.getElementById('difficulties').value = state.difficulties;
        if (state.remedialActions) document.getElementById('remedial-actions').value = state.remedialActions;
        
        updateRegionUI();
        setupPlanTab();
        setupReportsTab();

        fontSelect.addEventListener('change', (e) => {
            document.body.style.fontFamily = e.target.value;
            state.fontFamily = e.target.value;
            saveState();
        });

        if(state.fontFamily) {
            document.body.style.fontFamily = state.fontFamily;
            fontSelect.value = state.fontFamily;
        } else {
            fontSelect.value = 'Tajawal';
        }

        if(state.objective) {
            setTimeout(() => { 
                objectiveSelect.value = state.objective;
            }, 100);
        }
    }
    
    initializeApp();
});
</script>
</body>
</html>